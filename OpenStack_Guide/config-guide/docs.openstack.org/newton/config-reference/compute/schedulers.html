<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  
<!-- Mirrored from docs.openstack.org/newton/config-reference/compute/schedulers.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Jan 2017 10:20:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Compute schedulers</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../../../../maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">
<link href="../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="../_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="http://docs.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org/">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org/">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://ask.openstack.org/">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/videos/summits">Summit Videos</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
    <h2>Compute schedulers</h2>
  </div>
  <div class="docs-actions">
    
    <a href="hypervisor-virtuozzo.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Virtuozzo"></i></a>
    
    
    <a href="cells.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Cells"></i></a>
    
    <a id="logABugLink1" href="#" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2016-12-31 09:03</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../index-2.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Compute schedulers</a><ul>
<li><a class="reference internal" href="#filter-scheduler">Filter scheduler</a></li>
<li><a class="reference internal" href="#compute-filters">Compute filters</a><ul>
<li><a class="reference internal" href="#aggregatecorefilter">AggregateCoreFilter</a></li>
<li><a class="reference internal" href="#aggregatediskfilter">AggregateDiskFilter</a></li>
<li><a class="reference internal" href="#aggregateimagepropertiesisolation">AggregateImagePropertiesIsolation</a></li>
<li><a class="reference internal" href="#aggregateinstanceextraspecsfilter">AggregateInstanceExtraSpecsFilter</a></li>
<li><a class="reference internal" href="#aggregateioopsfilter">AggregateIoOpsFilter</a></li>
<li><a class="reference internal" href="#aggregatemultitenancyisolation">AggregateMultiTenancyIsolation</a></li>
<li><a class="reference internal" href="#aggregatenuminstancesfilter">AggregateNumInstancesFilter</a></li>
<li><a class="reference internal" href="#aggregateramfilter">AggregateRamFilter</a></li>
<li><a class="reference internal" href="#aggregatetypeaffinityfilter">AggregateTypeAffinityFilter</a></li>
<li><a class="reference internal" href="#allhostsfilter">AllHostsFilter</a></li>
<li><a class="reference internal" href="#availabilityzonefilter">AvailabilityZoneFilter</a></li>
<li><a class="reference internal" href="#computecapabilitiesfilter">ComputeCapabilitiesFilter</a></li>
<li><a class="reference internal" href="#computefilter">ComputeFilter</a></li>
<li><a class="reference internal" href="#corefilter">CoreFilter</a></li>
<li><a class="reference internal" href="#differenthostfilter">DifferentHostFilter</a></li>
<li><a class="reference internal" href="#diskfilter">DiskFilter</a></li>
<li><a class="reference internal" href="#exactcorefilter">ExactCoreFilter</a></li>
<li><a class="reference internal" href="#exactdiskfilter">ExactDiskFilter</a></li>
<li><a class="reference internal" href="#exactramfilter">ExactRamFilter</a></li>
<li><a class="reference internal" href="#groupaffinityfilter">GroupAffinityFilter</a></li>
<li><a class="reference internal" href="#groupantiaffinityfilter">GroupAntiAffinityFilter</a></li>
<li><a class="reference internal" href="#imagepropertiesfilter">ImagePropertiesFilter</a></li>
<li><a class="reference internal" href="#isolatedhostsfilter">IsolatedHostsFilter</a></li>
<li><a class="reference internal" href="#ioopsfilter">IoOpsFilter</a></li>
<li><a class="reference internal" href="#jsonfilter">JsonFilter</a></li>
<li><a class="reference internal" href="#metricsfilter">MetricsFilter</a></li>
<li><a class="reference internal" href="#numatopologyfilter">NUMATopologyFilter</a></li>
<li><a class="reference internal" href="#numinstancesfilter">NumInstancesFilter</a></li>
<li><a class="reference internal" href="#pcipassthroughfilter">PciPassthroughFilter</a></li>
<li><a class="reference internal" href="#ramfilter">RamFilter</a></li>
<li><a class="reference internal" href="#retryfilter">RetryFilter</a></li>
<li><a class="reference internal" href="#samehostfilter">SameHostFilter</a></li>
<li><a class="reference internal" href="#servergroupaffinityfilter">ServerGroupAffinityFilter</a></li>
<li><a class="reference internal" href="#servergroupantiaffinityfilter">ServerGroupAntiAffinityFilter</a></li>
<li><a class="reference internal" href="#simplecidraffinityfilter">SimpleCIDRAffinityFilter</a></li>
<li><a class="reference internal" href="#trustedfilter">TrustedFilter</a></li>
<li><a class="reference internal" href="#typeaffinityfilter">TypeAffinityFilter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cell-filters">Cell filters</a><ul>
<li><a class="reference internal" href="#differentcellfilter">DifferentCellFilter</a></li>
<li><a class="reference internal" href="#id15">ImagePropertiesFilter</a></li>
<li><a class="reference internal" href="#targetcellfilter">TargetCellFilter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#weights">Weights</a></li>
<li><a class="reference internal" href="#chance-scheduler">Chance scheduler</a></li>
<li><a class="reference internal" href="#utilization-aware-scheduling">Utilization aware scheduling</a></li>
<li><a class="reference internal" href="#host-aggregates-and-availability-zones">Host aggregates and availability zones</a><ul>
<li><a class="reference internal" href="#command-line-interface">Command-line interface</a></li>
<li><a class="reference internal" href="#configure-scheduler-to-support-host-aggregates">Configure scheduler to support host aggregates</a></li>
<li><a class="reference internal" href="#example-specify-compute-hosts-with-ssds">Example: Specify compute hosts with SSDs</a></li>
<li><a class="reference internal" href="#xenserver-hypervisor-pools-to-support-live-migration">XenServer hypervisor pools to support live migration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration-options">Configuration options</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="compute-schedulers">
<h1>Compute schedulers<a class="headerlink" href="#compute-schedulers" title="Permalink to this headline">¶</a></h1>
<p>Compute uses the <code class="docutils literal"><span class="pre">nova-scheduler</span></code> service to determine how to
dispatch compute requests. For example, the <code class="docutils literal"><span class="pre">nova-scheduler</span></code>
service determines on which host a VM should launch.
In the context of filters, the term <code class="docutils literal"><span class="pre">host</span></code> means a physical
node that has a <code class="docutils literal"><span class="pre">nova-compute</span></code> service running on it.
You can configure the scheduler through a variety of options.</p>
<p>Compute is configured with the following default scheduler
options in the <code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code> file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">scheduler_driver_task_period</span> <span class="o">=</span> <span class="s">60</span>
<span class="na">scheduler_driver</span> <span class="o">=</span> <span class="s">nova.scheduler.filter_scheduler.FilterScheduler</span>
<span class="na">scheduler_available_filters</span> <span class="o">=</span> <span class="s">nova.scheduler.filters.all_filters</span>
<span class="na">scheduler_default_filters</span> <span class="o">=</span> <span class="s">RetryFilter, AvailabilityZoneFilter, RamFilter, DiskFilter, ComputeFilter, ComputeCapabilitiesFilter, ImagePropertiesFilter, ServerGroupAntiAffinityFilter, ServerGroupAffinityFilter</span>
</pre></div>
</div>
<p>By default, the <code class="docutils literal"><span class="pre">scheduler_driver</span></code> is configured as a filter scheduler,
as described in the next section. In the default configuration,
this scheduler considers hosts that meet all the following criteria:</p>
<ul class="simple">
<li>Have not been attempted for scheduling purposes (<code class="docutils literal"><span class="pre">RetryFilter</span></code>).</li>
<li>Are in the requested availability zone (<code class="docutils literal"><span class="pre">AvailabilityZoneFilter</span></code>).</li>
<li>Have sufficient RAM available (<code class="docutils literal"><span class="pre">RamFilter</span></code>).</li>
<li>Have sufficient disk space available for root and ephemeral storage
(<code class="docutils literal"><span class="pre">DiskFilter</span></code>).</li>
<li>Can service the request (<code class="docutils literal"><span class="pre">ComputeFilter</span></code>).</li>
<li>Satisfy the extra specs associated with the instance type
(<code class="docutils literal"><span class="pre">ComputeCapabilitiesFilter</span></code>).</li>
<li>Satisfy any architecture, hypervisor type, or virtual machine mode
properties specified on the instance&#8217;s image properties
(<code class="docutils literal"><span class="pre">ImagePropertiesFilter</span></code>).</li>
<li>Are on a different host than other instances of a group (if requested)
(<code class="docutils literal"><span class="pre">ServerGroupAntiAffinityFilter</span></code>).</li>
<li>Are in a set of group hosts (if requested) (<code class="docutils literal"><span class="pre">ServerGroupAffinityFilter</span></code>).</li>
</ul>
<p>The scheduler caches its list of available hosts;
use the <code class="docutils literal"><span class="pre">scheduler_driver_task_period</span></code> option to specify
how often the list is updated.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not configure <code class="docutils literal"><span class="pre">service_down_time</span></code> to be much smaller than
<code class="docutils literal"><span class="pre">scheduler_driver_task_period</span></code>; otherwise, hosts appear to
be dead while the host list is being cached.</p>
</div>
<p>For information about the volume scheduler, see the <a class="reference external" href="http://docs.openstack.org/admin-guide/blockstorage-manage-volumes.html">Block Storage section</a>
of OpenStack Administrator Guide.</p>
<p>The scheduler chooses a new host when an instance is migrated.</p>
<p>When evacuating instances from a host, the scheduler service honors
the target host defined by the administrator on the
<strong class="command">nova evacuate</strong> command.
If a target is not defined by the administrator, the scheduler
determines the target host. For information about instance evacuation,
see <a class="reference external" href="http://docs.openstack.org/admin-guide/compute-node-down.html#evacuate-instances">Evacuate instances</a> section of the
OpenStack Administrator Guide.</p>
<div class="section" id="filter-scheduler">
<span id="compute-scheduler-filters"></span><h2>Filter scheduler<a class="headerlink" href="#filter-scheduler" title="Permalink to this headline">¶</a></h2>
<p>The filter scheduler (<code class="docutils literal"><span class="pre">nova.scheduler.filter_scheduler.FilterScheduler</span></code>)
is the default scheduler for scheduling virtual machine instances.
It supports filtering and weighting to make informed decisions on
where a new instance should be created.</p>
<p>When the filter scheduler receives a request for a resource, it first
applies filters to determine which hosts are eligible for consideration
when dispatching a resource. Filters are binary: either a host is
accepted by the filter, or it is rejected. Hosts that are accepted by
the filter are then processed by a different algorithm to decide which
hosts to use for that request, described in the <a class="reference internal" href="#weights"><span>Weights</span></a> section.</p>
<p><strong>Filtering</strong></p>
<div class="figure">
<img alt="../_images/filteringWorkflow1.png" src="../_images/filteringWorkflow1.png" />
</div>
<p>The <code class="docutils literal"><span class="pre">scheduler_available_filters</span></code> configuration option in <code class="docutils literal"><span class="pre">nova.conf</span></code>
provides the Compute service with the list of the filters that are used
by the scheduler. The default setting specifies all of the filter that
are included with the Compute service:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">scheduler_available_filters</span> <span class="o">=</span> <span class="s">nova.scheduler.filters.all_filters</span>
</pre></div>
</div>
<p>This configuration option can be specified multiple times.
For example, if you implemented your own custom filter in Python called
<code class="docutils literal"><span class="pre">myfilter.MyFilter</span></code> and you wanted to use both the built-in filters
and your custom filter, your <code class="docutils literal"><span class="pre">nova.conf</span></code> file would contain:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">scheduler_available_filters</span> <span class="o">=</span> <span class="s">nova.scheduler.filters.all_filters</span>
<span class="na">scheduler_available_filters</span> <span class="o">=</span> <span class="s">myfilter.MyFilter</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">scheduler_default_filters</span></code> configuration option in <code class="docutils literal"><span class="pre">nova.conf</span></code>
defines the list of filters that are applied by the <code class="docutils literal"><span class="pre">nova-scheduler</span></code>
service. The default filters are:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">scheduler_default_filters</span> <span class="o">=</span> <span class="s">RetryFilter, AvailabilityZoneFilter, RamFilter, ComputeFilter, ComputeCapabilitiesFilter, ImagePropertiesFilter, ServerGroupAntiAffinityFilter, ServerGroupAffinityFilter</span>
</pre></div>
</div>
</div>
<div class="section" id="compute-filters">
<h2>Compute filters<a class="headerlink" href="#compute-filters" title="Permalink to this headline">¶</a></h2>
<p>The following sections describe the available compute filters.</p>
<div class="section" id="aggregatecorefilter">
<h3>AggregateCoreFilter<a class="headerlink" href="#aggregatecorefilter" title="Permalink to this headline">¶</a></h3>
<p>Filters host by CPU core numbers with a per-aggregate
<code class="docutils literal"><span class="pre">cpu_allocation_ratio</span></code> value. If the per-aggregate value
is not found, the value falls back to the global setting.
If the host is in more than one aggregate and more than
one value is found, the minimum value will be used.
For information about how to use this filter,
see <a class="reference internal" href="#host-aggregates"><span>Host aggregates and availability zones</span></a>. See also <a class="reference internal" href="#corefilter"><span>CoreFilter</span></a>.</p>
</div>
<div class="section" id="aggregatediskfilter">
<h3>AggregateDiskFilter<a class="headerlink" href="#aggregatediskfilter" title="Permalink to this headline">¶</a></h3>
<p>Filters host by disk allocation with a per-aggregate
<code class="docutils literal"><span class="pre">disk_allocation_ratio</span></code> value. If the per-aggregate value
is not found, the value falls back to the global setting.
If the host is in more than one aggregate and more than
one value is found, the minimum value will be used.
For information about how to use this filter,
see <a class="reference internal" href="#host-aggregates"><span>Host aggregates and availability zones</span></a>. See also <a class="reference internal" href="#diskfilter"><span>DiskFilter</span></a>.</p>
</div>
<div class="section" id="aggregateimagepropertiesisolation">
<h3>AggregateImagePropertiesIsolation<a class="headerlink" href="#aggregateimagepropertiesisolation" title="Permalink to this headline">¶</a></h3>
<p>Matches properties defined in an image&#8217;s metadata against
those of aggregates to determine host matches:</p>
<ul class="simple">
<li>If a host belongs to an aggregate and the aggregate defines
one or more metadata that matches an image&#8217;s properties,
that host is a candidate to boot the image&#8217;s instance.</li>
<li>If a host does not belong to any aggregate,
it can boot instances from all images.</li>
</ul>
<p>For example, the following aggregate <code class="docutils literal"><span class="pre">myWinAgg</span></code> has the
Windows operating system as metadata (named &#8216;windows&#8217;):</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova aggregate-details MyWinAgg
<span class="go">+----+----------+-------------------+------------+---------------+</span>
<span class="go">| Id | Name     | Availability Zone | Hosts      | Metadata      |</span>
<span class="go">+----+----------+-------------------+------------+---------------+</span>
<span class="go">| 1  | MyWinAgg | None              | &#39;sf-devel&#39; | &#39;os=windows&#39;  |</span>
<span class="go">+----+----------+-------------------+------------+---------------+</span>
</pre></div>
</div>
<p>In this example, because the following Win-2012 image has the
<code class="docutils literal"><span class="pre">windows</span></code> property, it boots on the <code class="docutils literal"><span class="pre">sf-devel</span></code> host
(all other filters being equal):</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> glance image-show Win-2012
<span class="go">+------------------+--------------------------------------+</span>
<span class="go">| Property         | Value                                |</span>
<span class="go">+------------------+--------------------------------------+</span>
<span class="go">| Property &#39;os&#39;    | windows                              |</span>
<span class="go">| checksum         | f8a2eeee2dc65b3d9b6e63678955bd83     |</span>
<span class="go">| container_format | ami                                  |</span>
<span class="go">| created_at       | 2013-11-14T13:24:25                  |</span>
<span class="go">| ...</span>
</pre></div>
</div>
<p>You can configure the <code class="docutils literal"><span class="pre">AggregateImagePropertiesIsolation</span></code>
filter by using the following options in the <code class="docutils literal"><span class="pre">nova.conf</span></code> file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="c1"># Considers only keys matching the given namespace (string).</span>
<span class="c1"># Multiple values can be given, as a comma-separated list.</span>
<span class="na">aggregate_image_properties_isolation_namespace</span> <span class="o">=</span> <span class="s">&lt;None&gt;</span>

<span class="c1"># Separator used between the namespace and keys (string).</span>
<span class="na">aggregate_image_properties_isolation_separator</span> <span class="o">=</span> <span class="s">.</span>
</pre></div>
</div>
</div>
<div class="section" id="aggregateinstanceextraspecsfilter">
<span id="id1"></span><h3>AggregateInstanceExtraSpecsFilter<a class="headerlink" href="#aggregateinstanceextraspecsfilter" title="Permalink to this headline">¶</a></h3>
<p>Matches properties defined in extra specs for an instance type
against admin-defined properties on a host aggregate.
Works with specifications that are scoped with
<code class="docutils literal"><span class="pre">aggregate_instance_extra_specs</span></code>.
Multiple values can be given, as a comma-separated list.
For backward compatibility, also works with non-scoped specifications;
this action is highly discouraged because it conflicts with
<a class="reference internal" href="#computecapabilitiesfilter"><span>ComputeCapabilitiesFilter</span></a> filter when you enable both filters.
For information about how to use this filter, see the
<a class="reference internal" href="#host-aggregates"><span>Host aggregates and availability zones</span></a> section.</p>
</div>
<div class="section" id="aggregateioopsfilter">
<h3>AggregateIoOpsFilter<a class="headerlink" href="#aggregateioopsfilter" title="Permalink to this headline">¶</a></h3>
<p>Filters host by disk allocation with a per-aggregate
<code class="docutils literal"><span class="pre">max_io_ops_per_host</span></code> value. If the per-aggregate value
is not found, the value falls back to the global setting.
If the host is in more than one aggregate and more than one
value is found, the minimum value will be used.
For information about how to use this filter,
see <a class="reference internal" href="#host-aggregates"><span>Host aggregates and availability zones</span></a>. See also <a class="reference internal" href="#ioopsfilter"><span>IoOpsFilter</span></a>.</p>
</div>
<div class="section" id="aggregatemultitenancyisolation">
<h3>AggregateMultiTenancyIsolation<a class="headerlink" href="#aggregatemultitenancyisolation" title="Permalink to this headline">¶</a></h3>
<p>Ensures that the tenant (or list of tenants) creates all instances only
on specific <a class="reference internal" href="#host-aggregates"><span>Host aggregates and availability zones</span></a>. If a host is in an aggregate that has
the <code class="docutils literal"><span class="pre">filter_tenant_id</span></code> metadata key, the host creates instances from only
that tenant or list of tenants. A host can be in different aggregates. If a
host does not belong to an aggregate with the metadata key, the host can
create instances from all tenants. This setting does not isolate the
aggregate from other tenants. Any other tenant can continue to build
instances on the specified aggregate.</p>
</div>
<div class="section" id="aggregatenuminstancesfilter">
<h3>AggregateNumInstancesFilter<a class="headerlink" href="#aggregatenuminstancesfilter" title="Permalink to this headline">¶</a></h3>
<p>Filters host by number of instances with a per-aggregate
<code class="docutils literal"><span class="pre">max_instances_per_host</span></code> value. If the per-aggregate value
is not found, the value falls back to the global setting.
If the host is in more than one aggregate and thus more than
one value is found, the minimum value will be used.
For information about how to use this filter, see <a class="reference internal" href="#host-aggregates"><span>Host aggregates and availability zones</span></a>.
See also <a class="reference internal" href="#numinstancesfilter"><span>NumInstancesFilter</span></a>.</p>
</div>
<div class="section" id="aggregateramfilter">
<h3>AggregateRamFilter<a class="headerlink" href="#aggregateramfilter" title="Permalink to this headline">¶</a></h3>
<p>Filters host by RAM allocation of instances with a per-aggregate
<code class="docutils literal"><span class="pre">ram_allocation_ratio</span></code> value. If the per-aggregate value is not
found, the value falls back to the global setting.
If the host is in more than one aggregate and thus more than
one value is found, the minimum value will be used.
For information about how to use this filter, see <a class="reference internal" href="#host-aggregates"><span>Host aggregates and availability zones</span></a>.
See also <a class="reference internal" href="#ramfilter"><span>RamFilter</span></a>.</p>
</div>
<div class="section" id="aggregatetypeaffinityfilter">
<h3>AggregateTypeAffinityFilter<a class="headerlink" href="#aggregatetypeaffinityfilter" title="Permalink to this headline">¶</a></h3>
<p>This filter passes hosts if no <code class="docutils literal"><span class="pre">instance_type</span></code> key is set or the
<code class="docutils literal"><span class="pre">instance_type</span></code> aggregate metadata value contains the name of the
<code class="docutils literal"><span class="pre">instance_type</span></code> requested.  The value of the <code class="docutils literal"><span class="pre">instance_type</span></code>
metadata entry is a string that may contain either a single
<code class="docutils literal"><span class="pre">instance_type</span></code> name or a comma-separated list of <code class="docutils literal"><span class="pre">instance_type</span></code>
names, such as <code class="docutils literal"><span class="pre">m1.nano</span></code> or <code class="docutils literal"><span class="pre">m1.nano,m1.small</span></code>.
For information about how to use this filter, see <a class="reference internal" href="#host-aggregates"><span>Host aggregates and availability zones</span></a>.
See also <a class="reference internal" href="#typeaffinityfilter"><span>TypeAffinityFilter</span></a>.</p>
</div>
<div class="section" id="allhostsfilter">
<h3>AllHostsFilter<a class="headerlink" href="#allhostsfilter" title="Permalink to this headline">¶</a></h3>
<p>This is a no-op filter. It does not eliminate any of the available hosts.</p>
</div>
<div class="section" id="availabilityzonefilter">
<h3>AvailabilityZoneFilter<a class="headerlink" href="#availabilityzonefilter" title="Permalink to this headline">¶</a></h3>
<p>Filters hosts by availability zone. You must enable this filter
for the scheduler to respect availability zones in requests.</p>
</div>
<div class="section" id="computecapabilitiesfilter">
<span id="id2"></span><h3>ComputeCapabilitiesFilter<a class="headerlink" href="#computecapabilitiesfilter" title="Permalink to this headline">¶</a></h3>
<p>Matches properties defined in extra specs for an instance type
against compute capabilities. If an extra specs key contains
a colon (<code class="docutils literal"><span class="pre">:</span></code>), anything before the colon is treated as a namespace
and anything after the colon is treated as the key to be matched.
If a namespace is present and is not <code class="docutils literal"><span class="pre">capabilities</span></code>, the filter
ignores the namespace. For backward compatibility, also treats the
extra specs key as the key to be matched if no namespace is present;
this action is highly discouraged because it conflicts with
<a class="reference internal" href="#aggregateinstanceextraspecsfilter"><span>AggregateInstanceExtraSpecsFilter</span></a> filter when you enable both filters.</p>
</div>
<div class="section" id="computefilter">
<span id="id3"></span><h3>ComputeFilter<a class="headerlink" href="#computefilter" title="Permalink to this headline">¶</a></h3>
<p>Passes all hosts that are operational and enabled.</p>
<p>In general, you should always enable this filter.</p>
</div>
<div class="section" id="corefilter">
<span id="id4"></span><h3>CoreFilter<a class="headerlink" href="#corefilter" title="Permalink to this headline">¶</a></h3>
<p>Only schedules instances on hosts if sufficient CPU cores are available.
If this filter is not set, the scheduler might over-provision a host
based on cores. For example, the virtual cores running on an instance
may exceed the physical cores.</p>
<p>You can configure this filter to enable a fixed amount of vCPU
overcommitment by using the <code class="docutils literal"><span class="pre">cpu_allocation_ratio</span></code> configuration
option in <code class="docutils literal"><span class="pre">nova.conf</span></code>. The default setting is:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">cpu_allocation_ratio</span> <span class="o">=</span> <span class="s">16.0</span>
</pre></div>
</div>
<p>With this setting, if 8 vCPUs are on a node, the scheduler allows
instances up to 128 vCPU to be run on that node.</p>
<p>To disallow vCPU overcommitment set:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">cpu_allocation_ratio</span> <span class="o">=</span> <span class="s">1.0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Compute API always returns the actual number of CPU cores available
on a compute node regardless of the value of the <code class="docutils literal"><span class="pre">cpu_allocation_ratio</span></code>
configuration key. As a result changes to the <code class="docutils literal"><span class="pre">cpu_allocation_ratio</span></code>
are not reflected via the command line clients or the dashboard.
Changes to this configuration key are only taken into account internally
in the scheduler.</p>
</div>
</div>
<div class="section" id="differenthostfilter">
<h3>DifferentHostFilter<a class="headerlink" href="#differenthostfilter" title="Permalink to this headline">¶</a></h3>
<p>Schedules the instance on a different host from a set of instances.
To take advantage of this filter, the requester must pass a scheduler hint,
using <code class="docutils literal"><span class="pre">different_host</span></code> as the key and a list of instance UUIDs as
the value. This filter is the opposite of the <code class="docutils literal"><span class="pre">SameHostFilter</span></code>.
Using the <strong class="command">nova</strong> command-line client, use the <code class="docutils literal"><span class="pre">--hint</span></code> flag.
For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova boot --image cedef40a-ed67-4d10-800e-17455edce175 --flavor <span class="m">1</span> <span class="se">\</span>
<span class="go">  --hint different_host=a0cf03a5-d921-4877-bb5c-86d26cf818e1 \</span>
<span class="go">  --hint different_host=8c19174f-4220-44f0-824a-cd1eeef10287 server-1</span>
</pre></div>
</div>
<p>With the API, use the <code class="docutils literal"><span class="pre">os:scheduler_hints</span></code> key. For example:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;server&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;server-1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;imageRef&quot;</span><span class="p">:</span> <span class="s2">&quot;cedef40a-ed67-4d10-800e-17455edce175&quot;</span><span class="p">,</span>
        <span class="nt">&quot;flavorRef&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;os:scheduler_hints&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;different_host&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;a0cf03a5-d921-4877-bb5c-86d26cf818e1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;8c19174f-4220-44f0-824a-cd1eeef10287&quot;</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="diskfilter">
<span id="id5"></span><h3>DiskFilter<a class="headerlink" href="#diskfilter" title="Permalink to this headline">¶</a></h3>
<p>Only schedules instances on hosts if there is sufficient disk space
available for root and ephemeral storage.</p>
<p>You can configure this filter to enable a fixed amount of disk
overcommitment by using the <code class="docutils literal"><span class="pre">disk_allocation_ratio</span></code> configuration
option in the <code class="docutils literal"><span class="pre">nova.conf</span></code> configuration file.
The default setting disables the possibility of the overcommitment
and allows launching a VM only if there is a sufficient amount of
disk space available on a host:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">disk_allocation_ratio</span> <span class="o">=</span> <span class="s">1.0</span>
</pre></div>
</div>
<p>DiskFilter always considers the value of the <code class="docutils literal"><span class="pre">disk_available_least</span></code>
property and not the one of the <code class="docutils literal"><span class="pre">free_disk_gb</span></code> property of
a hypervisor&#8217;s statistics:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova hypervisor-stats
<span class="go">+----------------------+-------+</span>
<span class="go">| Property             | Value |</span>
<span class="go">+----------------------+-------+</span>
<span class="go">| count                |  1    |</span>
<span class="go">| current_workload     |  0    |</span>
<span class="go">| disk_available_least |  29   |</span>
<span class="go">| free_disk_gb         |  35   |</span>
<span class="go">| free_ram_mb          |  3441 |</span>
<span class="go">| local_gb             |  35   |</span>
<span class="go">| local_gb_used        |  0    |</span>
<span class="go">| memory_mb            |  3953 |</span>
<span class="go">| memory_mb_used       |  512  |</span>
<span class="go">| running_vms          |  0    |</span>
<span class="go">| vcpus                |  2    |</span>
<span class="go">| vcpus_used           |  0    |</span>
<span class="go">+----------------------+-------+</span>
</pre></div>
</div>
<p>As it can be viewed from the command output above, the amount of the
available disk space can be less than the amount of the free disk space.
It happens because the <code class="docutils literal"><span class="pre">disk_available_least</span></code> property accounts
for the virtual size rather than the actual size of images.
If you use an image format that is sparse or copy on write so that each
virtual instance does not require a 1:1 allocation of a virtual disk to a
physical storage, it may be useful to allow the overcommitment of disk space.</p>
<p>To enable scheduling instances while overcommitting disk resources on the
node, adjust the value of the <code class="docutils literal"><span class="pre">disk_allocation_ratio</span></code> configuration
option to greater than <code class="docutils literal"><span class="pre">1.0</span></code>:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span>disk_allocation_ratio &gt; 1.0
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the value is set to <code class="docutils literal"><span class="pre">&gt;1</span></code>, we recommend keeping track of the free
disk space, as the value approaching <code class="docutils literal"><span class="pre">0</span></code> may result in the incorrect
functioning of instances using it at the moment.</p>
</div>
</div>
<div class="section" id="exactcorefilter">
<h3>ExactCoreFilter<a class="headerlink" href="#exactcorefilter" title="Permalink to this headline">¶</a></h3>
<p>Only schedules instances on hosts if host has the exact number of CPU cores.</p>
</div>
<div class="section" id="exactdiskfilter">
<h3>ExactDiskFilter<a class="headerlink" href="#exactdiskfilter" title="Permalink to this headline">¶</a></h3>
<p>Only schedules instances on hosts if host has the exact amount of disk
available.</p>
</div>
<div class="section" id="exactramfilter">
<h3>ExactRamFilter<a class="headerlink" href="#exactramfilter" title="Permalink to this headline">¶</a></h3>
<p>Only schedules instances on hosts if host has the exact number of RAM
available.</p>
</div>
<div class="section" id="groupaffinityfilter">
<span id="id6"></span><h3>GroupAffinityFilter<a class="headerlink" href="#groupaffinityfilter" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This filter is deprecated in favor of <a class="reference internal" href="#servergroupaffinityfilter"><span>ServerGroupAffinityFilter</span></a>.</p>
</div>
<p>The GroupAffinityFilter ensures that an instance is scheduled on to a host
from a set of group hosts. To take advantage of this filter, the requester
must pass a scheduler hint, using <code class="docutils literal"><span class="pre">group</span></code> as the key and an arbitrary name
as the value. Using the <strong class="command">nova</strong> command-line client,
use the <code class="docutils literal"><span class="pre">--hint</span></code> flag. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova boot --image IMAGE_ID --flavor <span class="m">1</span> --hint <span class="nv">group</span><span class="o">=</span>foo server-1
</pre></div>
</div>
<p>This filter should not be enabled at the same time as
<a class="reference internal" href="#groupantiaffinityfilter"><span>GroupAntiAffinityFilter</span></a> or neither filter will work properly.</p>
</div>
<div class="section" id="groupantiaffinityfilter">
<span id="id7"></span><h3>GroupAntiAffinityFilter<a class="headerlink" href="#groupantiaffinityfilter" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This filter is deprecated in favor of <a class="reference internal" href="#servergroupantiaffinityfilter"><span>ServerGroupAntiAffinityFilter</span></a>.</p>
</div>
<p>The GroupAntiAffinityFilter ensures that each instance in a group is on
a different host. To take advantage of this filter, the requester must
pass a scheduler hint, using <code class="docutils literal"><span class="pre">group</span></code> as the key and an arbitrary name
as the value. Using the <strong class="command">nova</strong> command-line client,
use the <code class="docutils literal"><span class="pre">--hint</span></code> flag. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova boot --image IMAGE_ID --flavor <span class="m">1</span> --hint <span class="nv">group</span><span class="o">=</span>foo server-1
</pre></div>
</div>
<p>This filter should not be enabled at the same time as
<a class="reference internal" href="#groupaffinityfilter"><span>GroupAffinityFilter</span></a> or neither filter will work properly.</p>
</div>
<div class="section" id="imagepropertiesfilter">
<span id="id8"></span><h3>ImagePropertiesFilter<a class="headerlink" href="#imagepropertiesfilter" title="Permalink to this headline">¶</a></h3>
<p>Filters hosts based on properties defined on the instance&#8217;s image.
It passes hosts that can support the specified image properties contained
in the instance. Properties include the architecture, hypervisor type,
hypervisor version (for Xen hypervisor type only), and virtual machine mode.</p>
<p>For example, an instance might require a host that runs an ARM-based
processor, and QEMU as the hypervisor.
You can decorate an image with these properties by using:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> glance image-update img-uuid --property <span class="nv">architecture</span><span class="o">=</span>arm --property <span class="nv">hypervisor_type</span><span class="o">=</span>qemu
</pre></div>
</div>
<p>The image properties that the filter checks for are:</p>
<dl class="docutils">
<dt>architecture</dt>
<dd>describes the machine architecture required by the image.
Examples are <code class="docutils literal"><span class="pre">i686</span></code>, <code class="docutils literal"><span class="pre">x86_64</span></code>, <code class="docutils literal"><span class="pre">arm</span></code>, and <code class="docutils literal"><span class="pre">ppc64</span></code>.</dd>
<dt>hypervisor_type</dt>
<dd><p class="first">describes the hypervisor required by the image.
Examples are <code class="docutils literal"><span class="pre">xen</span></code>, <code class="docutils literal"><span class="pre">qemu</span></code>, and <code class="docutils literal"><span class="pre">xenapi</span></code>.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">qemu</span></code> is used for both QEMU and KVM hypervisor types.</p>
</div>
</dd>
<dt>hypervisor_version_requires</dt>
<dd><p class="first">describes the hypervisor version required by the image.
The property is supported for Xen hypervisor type only.
It can be used to enable support for multiple hypervisor versions,
and to prevent instances with newer Xen tools from being provisioned
on an older version of a hypervisor. If available, the property value
is compared to the hypervisor version of the compute host.</p>
<p>To filter the hosts by the hypervisor version, add the
<code class="docutils literal"><span class="pre">hypervisor_version_requires</span></code> property on the image as metadata and
pass an operator and a required hypervisor version as its value:</p>
<div class="last highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> glance image-update img-uuid --property <span class="nv">hypervisor_type</span><span class="o">=</span>xen --property <span class="nv">hypervisor_version_requires</span><span class="o">=</span><span class="s2">&quot;&gt;=4.3&quot;</span>
</pre></div>
</div>
</dd>
<dt>vm_mode</dt>
<dd>describes the hypervisor application binary interface (ABI) required
by the image. Examples are <code class="docutils literal"><span class="pre">xen</span></code> for Xen 3.0 paravirtual ABI,
<code class="docutils literal"><span class="pre">hvm</span></code> for native ABI, <code class="docutils literal"><span class="pre">uml</span></code> for User Mode Linux paravirtual ABI,
<code class="docutils literal"><span class="pre">exe</span></code> for container virt executable ABI.</dd>
</dl>
</div>
<div class="section" id="isolatedhostsfilter">
<h3>IsolatedHostsFilter<a class="headerlink" href="#isolatedhostsfilter" title="Permalink to this headline">¶</a></h3>
<p>Allows the admin to define a special (isolated) set of images and a special
(isolated) set of hosts, such that the isolated images can only run on
the isolated hosts, and the isolated hosts can only run isolated images.
The flag <code class="docutils literal"><span class="pre">restrict_isolated_hosts_to_isolated_images</span></code> can be used to
force isolated hosts to only run isolated images.</p>
<p>The admin must specify the isolated set of images and hosts in the
<code class="docutils literal"><span class="pre">nova.conf</span></code> file using the <code class="docutils literal"><span class="pre">isolated_hosts</span></code> and <code class="docutils literal"><span class="pre">isolated_images</span></code>
configuration options. For example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">isolated_hosts</span> <span class="o">=</span> <span class="s">server1, server2</span>
<span class="na">isolated_images</span> <span class="o">=</span> <span class="s">342b492c-128f-4a42-8d3a-c5088cf27d13, ebd267a6-ca86-4d6c-9a0e-bd132d6b7d09</span>
</pre></div>
</div>
</div>
<div class="section" id="ioopsfilter">
<span id="id9"></span><h3>IoOpsFilter<a class="headerlink" href="#ioopsfilter" title="Permalink to this headline">¶</a></h3>
<p>The IoOpsFilter filters hosts by concurrent I/O operations on it.
Hosts with too many concurrent I/O operations will be filtered out.
The <code class="docutils literal"><span class="pre">max_io_ops_per_host</span></code> option specifies the maximum number of
I/O intensive instances allowed to run on a host.
A host will be ignored by the scheduler if more than
<code class="docutils literal"><span class="pre">max_io_ops_per_host</span></code> instances in build, resize, snapshot,
migrate, rescue or unshelve task states are running on it.</p>
</div>
<div class="section" id="jsonfilter">
<h3>JsonFilter<a class="headerlink" href="#jsonfilter" title="Permalink to this headline">¶</a></h3>
<p>The JsonFilter allows a user to construct a custom filter by passing
a scheduler hint in JSON format. The following operators are supported:</p>
<ul class="simple">
<li>=</li>
<li>&lt;</li>
<li>&gt;</li>
<li>in</li>
<li>&lt;=</li>
<li>&gt;=</li>
<li>not</li>
<li>or</li>
<li>and</li>
</ul>
<p>The filter supports the following variables:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$free_ram_mb</span></code></li>
<li><code class="docutils literal"><span class="pre">$free_disk_mb</span></code></li>
<li><code class="docutils literal"><span class="pre">$total_usable_ram_mb</span></code></li>
<li><code class="docutils literal"><span class="pre">$vcpus_total</span></code></li>
<li><code class="docutils literal"><span class="pre">$vcpus_used</span></code></li>
</ul>
<p>Using the <strong class="command">nova</strong> command-line client, use the <code class="docutils literal"><span class="pre">--hint</span></code> flag:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova boot --image 827d564a-e636-4fc4-a376-d36f7ebe1747 <span class="se">\</span>
<span class="go">  --flavor 1 --hint query=&#39;[&quot;&gt;=&quot;,&quot;$free_ram_mb&quot;,1024]&#39; server1</span>
</pre></div>
</div>
<p>With the API, use the <code class="docutils literal"><span class="pre">os:scheduler_hints</span></code> key:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;server&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;server-1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;imageRef&quot;</span><span class="p">:</span> <span class="s2">&quot;cedef40a-ed67-4d10-800e-17455edce175&quot;</span><span class="p">,</span>
        <span class="nt">&quot;flavorRef&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;os:scheduler_hints&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;query&quot;</span><span class="p">:</span> <span class="s2">&quot;[&gt;=,$free_ram_mb,1024]&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="metricsfilter">
<h3>MetricsFilter<a class="headerlink" href="#metricsfilter" title="Permalink to this headline">¶</a></h3>
<p>Filters hosts based on meters <code class="docutils literal"><span class="pre">weight_setting</span></code>.
Only hosts with the available meters are passed so that
the metrics weigher will not fail due to these hosts.</p>
</div>
<div class="section" id="numatopologyfilter">
<h3>NUMATopologyFilter<a class="headerlink" href="#numatopologyfilter" title="Permalink to this headline">¶</a></h3>
<p>Filters hosts based on the NUMA topology that was specified for the
instance through the use of flavor <code class="docutils literal"><span class="pre">extra_specs</span></code> in combination
with the image properties, as described in detail in the
<a class="reference external" href="http://specs.openstack.org/openstack/nova-specs/specs/juno/implemented/virt-driver-numa-placement.html">related nova-spec document</a>.
Filter will try to match the exact NUMA cells of the instance to
those of the host. It will consider the standard over-subscription
limits each cell, and provide limits to the compute host accordingly.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If instance has no topology defined, it will be considered for any host.
If instance has a topology defined, it will be considered only for NUMA
capable hosts.</p>
</div>
</div>
<div class="section" id="numinstancesfilter">
<span id="id10"></span><h3>NumInstancesFilter<a class="headerlink" href="#numinstancesfilter" title="Permalink to this headline">¶</a></h3>
<p>Hosts that have more instances running than specified by the
<code class="docutils literal"><span class="pre">max_instances_per_host</span></code> option are filtered out when this filter
is in place.</p>
</div>
<div class="section" id="pcipassthroughfilter">
<h3>PciPassthroughFilter<a class="headerlink" href="#pcipassthroughfilter" title="Permalink to this headline">¶</a></h3>
<p>The filter schedules instances on a host if the host has devices that
meet the device requests in the <code class="docutils literal"><span class="pre">extra_specs</span></code> attribute for the flavor.</p>
</div>
<div class="section" id="ramfilter">
<span id="id11"></span><h3>RamFilter<a class="headerlink" href="#ramfilter" title="Permalink to this headline">¶</a></h3>
<p>Only schedules instances on hosts that have sufficient RAM available.
If this filter is not set, the scheduler may over provision a host
based on RAM (for example, the RAM allocated by virtual machine
instances may exceed the physical RAM).</p>
<p>You can configure this filter to enable a fixed amount of RAM
overcommitment by using the <code class="docutils literal"><span class="pre">ram_allocation_ratio</span></code> configuration
option in <code class="docutils literal"><span class="pre">nova.conf</span></code>. The default setting is:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">ram_allocation_ratio</span> <span class="o">=</span> <span class="s">1.5</span>
</pre></div>
</div>
<p>This setting enables 1.5&amp;nbsp;GB instances to run on any compute node
with 1 GB of free RAM.</p>
</div>
<div class="section" id="retryfilter">
<h3>RetryFilter<a class="headerlink" href="#retryfilter" title="Permalink to this headline">¶</a></h3>
<p>Filters out hosts that have already been attempted for scheduling purposes.
If the scheduler selects a host to respond to a service request,
and the host fails to respond to the request, this filter prevents
the scheduler from retrying that host for the service request.</p>
<p>This filter is only useful if the <code class="docutils literal"><span class="pre">scheduler_max_attempts</span></code>
configuration option is set to a value greater than zero.</p>
</div>
<div class="section" id="samehostfilter">
<h3>SameHostFilter<a class="headerlink" href="#samehostfilter" title="Permalink to this headline">¶</a></h3>
<p>Schedules the instance on the same host as another instance in a set
of instances. To take advantage of this filter, the requester must
pass a scheduler hint, using <code class="docutils literal"><span class="pre">same_host</span></code> as the key and a
list of instance UUIDs as the value.
This filter is the opposite of the <code class="docutils literal"><span class="pre">DifferentHostFilter</span></code>.
Using the <strong class="command">nova</strong> command-line client, use the <code class="docutils literal"><span class="pre">--hint</span></code> flag:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova boot --image cedef40a-ed67-4d10-800e-17455edce175 --flavor <span class="m">1</span> <span class="se">\</span>
<span class="go">  --hint same_host=a0cf03a5-d921-4877-bb5c-86d26cf818e1 \</span>
<span class="go">  --hint same_host=8c19174f-4220-44f0-824a-cd1eeef10287 server-1</span>
</pre></div>
</div>
<p>With the API, use the <code class="docutils literal"><span class="pre">os:scheduler_hints</span></code> key:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;server&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;server-1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;imageRef&quot;</span><span class="p">:</span> <span class="s2">&quot;cedef40a-ed67-4d10-800e-17455edce175&quot;</span><span class="p">,</span>
        <span class="nt">&quot;flavorRef&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;os:scheduler_hints&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;same_host&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;a0cf03a5-d921-4877-bb5c-86d26cf818e1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;8c19174f-4220-44f0-824a-cd1eeef10287&quot;</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="servergroupaffinityfilter">
<span id="id12"></span><h3>ServerGroupAffinityFilter<a class="headerlink" href="#servergroupaffinityfilter" title="Permalink to this headline">¶</a></h3>
<p>The ServerGroupAffinityFilter ensures that an instance is scheduled
on to a host from a set of group hosts. To take advantage of this filter,
the requester must create a server group with an <code class="docutils literal"><span class="pre">affinity</span></code> policy,
and pass a scheduler hint, using <code class="docutils literal"><span class="pre">group</span></code> as the key and the server
group UUID as the value.
Using the <strong class="command">nova</strong> command-line tool, use the <code class="docutils literal"><span class="pre">--hint</span></code> flag.
For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova server-group-create --policy affinity group-1
<span class="gp">$</span> nova boot --image IMAGE_ID --flavor <span class="m">1</span> --hint <span class="nv">group</span><span class="o">=</span>SERVER_GROUP_UUID server-1
</pre></div>
</div>
</div>
<div class="section" id="servergroupantiaffinityfilter">
<span id="id13"></span><h3>ServerGroupAntiAffinityFilter<a class="headerlink" href="#servergroupantiaffinityfilter" title="Permalink to this headline">¶</a></h3>
<p>The ServerGroupAntiAffinityFilter ensures that each instance in a group is
on a different host. To take advantage of this filter, the requester must
create a server group with an <code class="docutils literal"><span class="pre">anti-affinity</span></code> policy, and pass a scheduler
hint, using <code class="docutils literal"><span class="pre">group</span></code> as the key and the server group UUID as the value.
Using the <strong class="command">nova</strong> command-line client, use the <code class="docutils literal"><span class="pre">--hint</span></code> flag.
For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova server-group-create --policy anti-affinity group-1
<span class="gp">$</span> nova boot --image IMAGE_ID --flavor <span class="m">1</span> --hint <span class="nv">group</span><span class="o">=</span>SERVER_GROUP_UUID server-1
</pre></div>
</div>
</div>
<div class="section" id="simplecidraffinityfilter">
<h3>SimpleCIDRAffinityFilter<a class="headerlink" href="#simplecidraffinityfilter" title="Permalink to this headline">¶</a></h3>
<p>Schedules the instance based on host IP subnet range.
To take advantage of this filter, the requester must specify a range
of valid IP address in CIDR format, by passing two scheduler hints:</p>
<dl class="docutils">
<dt>build_near_host_ip</dt>
<dd>The first IP address in the subnet (for example, <code class="docutils literal"><span class="pre">192.168.1.1</span></code>)</dd>
<dt>cidr</dt>
<dd>The CIDR that corresponds to the subnet (for example, <code class="docutils literal"><span class="pre">/24</span></code>)</dd>
</dl>
<p>Using the <strong class="command">nova</strong> command-line client, use the <code class="docutils literal"><span class="pre">--hint</span></code> flag.
For example, to specify the IP subnet <code class="docutils literal"><span class="pre">192.168.1.1/24</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova boot --image cedef40a-ed67-4d10-800e-17455edce175 --flavor <span class="m">1</span> <span class="se">\</span>
<span class="go">  --hint build_near_host_ip=192.168.1.1 --hint cidr=/24 server-1</span>
</pre></div>
</div>
<p>With the API, use the <code class="docutils literal"><span class="pre">os:scheduler_hints</span></code> key:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;server&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;server-1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;imageRef&quot;</span><span class="p">:</span> <span class="s2">&quot;cedef40a-ed67-4d10-800e-17455edce175&quot;</span><span class="p">,</span>
        <span class="nt">&quot;flavorRef&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;os:scheduler_hints&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;build_near_host_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.1.1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;cidr&quot;</span><span class="p">:</span> <span class="s2">&quot;24&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="trustedfilter">
<h3>TrustedFilter<a class="headerlink" href="#trustedfilter" title="Permalink to this headline">¶</a></h3>
<p>Filters hosts based on their trust. Only passes hosts that
meet the trust requirements specified in the instance properties.</p>
</div>
<div class="section" id="typeaffinityfilter">
<span id="id14"></span><h3>TypeAffinityFilter<a class="headerlink" href="#typeaffinityfilter" title="Permalink to this headline">¶</a></h3>
<p>Dynamically limits hosts to one instance type. An instance can only be
launched on a host, if no instance with different instances types
are running on it, or if the host has no running instances at all.</p>
</div>
</div>
<div class="section" id="cell-filters">
<h2>Cell filters<a class="headerlink" href="#cell-filters" title="Permalink to this headline">¶</a></h2>
<p>The following sections describe the available cell filters.</p>
<div class="section" id="differentcellfilter">
<h3>DifferentCellFilter<a class="headerlink" href="#differentcellfilter" title="Permalink to this headline">¶</a></h3>
<p>Schedules the instance on a different cell from a set of instances.
To take advantage of this filter, the requester must pass a scheduler hint,
using <code class="docutils literal"><span class="pre">different_cell</span></code> as the key and a list of instance UUIDs as the value.</p>
</div>
<div class="section" id="id15">
<h3>ImagePropertiesFilter<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>Filters cells based on properties defined on the instance’s image.
This filter works specifying the hypervisor required in the image
metadata and the supported hypervisor version in cell capabilities.</p>
</div>
<div class="section" id="targetcellfilter">
<h3>TargetCellFilter<a class="headerlink" href="#targetcellfilter" title="Permalink to this headline">¶</a></h3>
<p>Filters target cells. This filter works by specifying a scheduler
hint of <code class="docutils literal"><span class="pre">target_cell</span></code>. The value should be the full cell path.</p>
</div>
</div>
<div class="section" id="weights">
<span id="id16"></span><h2>Weights<a class="headerlink" href="#weights" title="Permalink to this headline">¶</a></h2>
<p>When resourcing instances, the filter scheduler filters and weights
each host in the list of acceptable hosts. Each time the scheduler
selects a host, it virtually consumes resources on it, and subsequent
selections are adjusted accordingly. This process is useful when the
customer asks for the same large amount of instances, because weight
is computed for each requested instance.</p>
<p>All weights are normalized before being summed up;
the host with the largest weight is given the highest priority.</p>
<p><strong>Weighting hosts</strong></p>
<div class="figure">
<img alt="../_images/nova-weighting-hosts.png" src="../_images/nova-weighting-hosts.png" />
</div>
<p>If cells are used, cells are weighted by the scheduler in the same
manner as hosts.</p>
<p>Hosts and cells are weighted based on the following options in
the <code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code> file:</p>
<table border="1" class="colwidths-given docutils" id="id17">
<caption><span class="caption-text">Host weighting options</span><a class="headerlink" href="#id17" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="11%" />
<col width="26%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Section</th>
<th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>[DEFAULT]</td>
<td><code class="docutils literal"><span class="pre">ram_weight_multiplier</span></code></td>
<td>By default, the scheduler spreads instances across all hosts evenly.
Set the <code class="docutils literal"><span class="pre">ram_weight_multiplier</span></code> option to a negative number if you
prefer stacking instead of spreading. Use a floating-point value.</td>
</tr>
<tr class="row-odd"><td>[DEFAULT]</td>
<td><code class="docutils literal"><span class="pre">scheduler_host_subset_size</span></code></td>
<td>New instances are scheduled on a host that is chosen randomly from a
subset of the N best hosts. This property defines the subset size
from which a host is chosen. A value of 1 chooses the first host
returned by the weighting functions. This value must be at least 1.
A value less than 1 is ignored, and 1 is used instead.
Use an integer value.</td>
</tr>
<tr class="row-even"><td>[DEFAULT]</td>
<td><code class="docutils literal"><span class="pre">scheduler_weight_classes</span></code></td>
<td>Defaults to <code class="docutils literal"><span class="pre">nova.scheduler.weights.all_weighers</span></code>.
Hosts are then weighted and sorted with the largest weight winning.</td>
</tr>
<tr class="row-odd"><td>[DEFAULT]</td>
<td><code class="docutils literal"><span class="pre">io_ops_weight_multiplier</span></code></td>
<td>Multiplier used for weighing host I/O operations. A negative
value means a preference to choose light workload compute hosts.</td>
</tr>
<tr class="row-even"><td>[DEFAULT]</td>
<td><code class="docutils literal"><span class="pre">soft_affinity_weight_multiplier</span></code></td>
<td>Multiplier used for weighing hosts for group soft-affinity.
Only a positive value is meaningful. Negative means that the
behavior will change to the opposite, which is soft-anti-affinity.</td>
</tr>
<tr class="row-odd"><td>[DEFAULT]</td>
<td><code class="docutils literal"><span class="pre">soft_anti_affinity_weight_multiplier</span></code></td>
<td>Multiplier used for weighing hosts for group soft-anti-affinity.
Only a positive value is meaningful. Negative means that the
behavior will change to the opposite, which is soft-affinity.</td>
</tr>
<tr class="row-even"><td>[metrics]</td>
<td><code class="docutils literal"><span class="pre">weight_multiplier</span></code></td>
<td>Multiplier for weighting meters. Use a floating-point value.</td>
</tr>
<tr class="row-odd"><td>[metrics]</td>
<td><code class="docutils literal"><span class="pre">weight_setting</span></code></td>
<td>Determines how meters are weighted. Use a comma-separated list of
metricName=ratio. For example: <code class="docutils literal"><span class="pre">name1=1.0,</span> <span class="pre">name2=-1.0</span></code> results in:
<code class="docutils literal"><span class="pre">name1.value</span> <span class="pre">*</span> <span class="pre">1.0</span> <span class="pre">+</span> <span class="pre">name2.value</span> <span class="pre">*</span> <span class="pre">-1.0</span></code></td>
</tr>
<tr class="row-even"><td>[metrics]</td>
<td><code class="docutils literal"><span class="pre">required</span></code></td>
<td><p class="first">Specifies how to treat unavailable meters:</p>
<ul class="last simple">
<li>True - Raises an exception. To avoid the raised exception,
you should use the scheduler filter <code class="docutils literal"><span class="pre">MetricFilter</span></code> to filter
out hosts with unavailable meters.</li>
<li>False - Treated as a negative factor in the weighting process
(uses the <code class="docutils literal"><span class="pre">weight_of_unavailable</span></code> option).</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>[metrics]</td>
<td><code class="docutils literal"><span class="pre">weight_of_unavailable</span></code></td>
<td>If <code class="docutils literal"><span class="pre">required</span></code> is set to False, and any one of the meters set by
<code class="docutils literal"><span class="pre">weight_setting</span></code> is unavailable, the <code class="docutils literal"><span class="pre">weight_of_unavailable</span></code>
value is returned to the scheduler.</td>
</tr>
</tbody>
</table>
<p>For example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">scheduler_host_subset_size</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">scheduler_weight_classes</span> <span class="o">=</span> <span class="s">nova.scheduler.weights.all_weighers</span>
<span class="na">ram_weight_multiplier</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">io_ops_weight_multiplier</span> <span class="o">=</span> <span class="s">2.0</span>
<span class="na">soft_affinity_weight_multiplier</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">soft_anti_affinity_weight_multiplier</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="k">[metrics]</span>
<span class="na">weight_multiplier</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">weight_setting</span> <span class="o">=</span> <span class="s">name1=1.0, name2=-1.0</span>
<span class="na">required</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">weight_of_unavailable</span> <span class="o">=</span> <span class="s">-10000.0</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils" id="id18">
<caption><span class="caption-text">Cell weighting options</span><a class="headerlink" href="#id18" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="11%" />
<col width="26%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Section</th>
<th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>[cells]</td>
<td><code class="docutils literal"><span class="pre">mute_weight_multiplier</span></code></td>
<td>Multiplier to weight mute children (hosts which have not sent
capacity or capacity updates for some time).
Use a negative, floating-point value.</td>
</tr>
<tr class="row-odd"><td>[cells]</td>
<td><code class="docutils literal"><span class="pre">offset_weight_multiplier</span></code></td>
<td>Multiplier to weight cells, so you can specify a preferred cell.
Use a floating point value.</td>
</tr>
<tr class="row-even"><td>[cells]</td>
<td><code class="docutils literal"><span class="pre">ram_weight_multiplier</span></code></td>
<td>By default, the scheduler spreads instances across all cells evenly.
Set the <code class="docutils literal"><span class="pre">ram_weight_multiplier</span></code> option to a negative number if you
prefer stacking instead of spreading. Use a floating-point value.</td>
</tr>
<tr class="row-odd"><td>[cells]</td>
<td><code class="docutils literal"><span class="pre">scheduler_weight_classes</span></code></td>
<td>Defaults to <code class="docutils literal"><span class="pre">nova.cells.weights.all_weighers</span></code>, which maps to all
cell weighers included with Compute. Cells are then weighted and
sorted with the largest weight winning.</td>
</tr>
</tbody>
</table>
<p>For example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[cells]</span>
<span class="na">scheduler_weight_classes</span> <span class="o">=</span> <span class="s">nova.cells.weights.all_weighers</span>
<span class="na">mute_weight_multiplier</span> <span class="o">=</span> <span class="s">-10.0</span>
<span class="na">ram_weight_multiplier</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">offset_weight_multiplier</span> <span class="o">=</span> <span class="s">1.0</span>
</pre></div>
</div>
</div>
<div class="section" id="chance-scheduler">
<h2>Chance scheduler<a class="headerlink" href="#chance-scheduler" title="Permalink to this headline">¶</a></h2>
<p>As an administrator, you work with the filter scheduler.
However, the Compute service also uses the Chance Scheduler,
<code class="docutils literal"><span class="pre">nova.scheduler.chance.ChanceScheduler</span></code>,
which randomly selects from lists of filtered hosts.</p>
</div>
<div class="section" id="utilization-aware-scheduling">
<h2>Utilization aware scheduling<a class="headerlink" href="#utilization-aware-scheduling" title="Permalink to this headline">¶</a></h2>
<p>It is possible to schedule VMs using advanced scheduling decisions.
These decisions are made based on enhanced usage statistics encompassing
data like memory cache utilization, memory bandwidth utilization,
or network bandwidth utilization. This is disabled by default.
The administrator can configure how the metrics are weighted in the
configuration file by using the <code class="docutils literal"><span class="pre">weight_setting</span></code> configuration option
in the <code class="docutils literal"><span class="pre">nova.conf</span></code> configuration file.
For example to configure metric1 with ratio1 and metric2 with ratio2:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">weight_setting</span> <span class="o">=</span> <span class="s">&quot;metric1=ratio1, metric2=ratio2&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="host-aggregates-and-availability-zones">
<span id="host-aggregates"></span><h2>Host aggregates and availability zones<a class="headerlink" href="#host-aggregates-and-availability-zones" title="Permalink to this headline">¶</a></h2>
<p>Host aggregates are a mechanism for partitioning hosts in an OpenStack
cloud, or a region of an OpenStack cloud, based on arbitrary characteristics.
Examples where an administrator may want to do this include where a group
of hosts have additional hardware or performance characteristics.</p>
<p>Host aggregates are not explicitly exposed to users.
Instead administrators map flavors to host aggregates.
Administrators do this by setting metadata on a host aggregate,
and matching flavor extra specifications.
The scheduler then endeavors to match user requests for instance of the
given flavor to a host aggregate with the same key-value pair in its metadata.
Compute nodes can be in more than one host aggregate.</p>
<p>Administrators are able to optionally expose a host aggregate as an
availability zone. Availability zones are different from host aggregates in
that they are explicitly exposed to the user, and hosts can only be in a
single availability zone. Administrators can configure a default availability
zone where instances will be scheduled when the user fails to specify one.</p>
<div class="section" id="command-line-interface">
<h3>Command-line interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">¶</a></h3>
<p>The <strong class="command">nova</strong> command-line client supports the following
aggregate-related commands.</p>
<dl class="docutils">
<dt>nova aggregate-list</dt>
<dd>Print a list of all aggregates.</dd>
<dt>nova aggregate-create &lt;name&gt; [availability-zone]</dt>
<dd>Create a new aggregate named <code class="docutils literal"><span class="pre">&lt;name&gt;</span></code>, and optionally in availability
zone <code class="docutils literal"><span class="pre">[availability-zone]</span></code> if specified. The command returns the ID of
the newly created aggregate. Hosts can be made available to multiple
host aggregates. Be careful when adding a host to an additional host
aggregate when the host is also in an availability zone. Pay attention
when using the <strong class="command">nova aggregate-set-metadata</strong> and
<strong class="command">nova aggregate-update</strong> commands to avoid user confusion when they
boot instances in different availability zones.
An error occurs if you cannot add a particular host to an aggregate zone
for which it is not intended.</dd>
<dt>nova aggregate-delete &lt;id&gt;</dt>
<dd>Delete an aggregate with id <code class="docutils literal"><span class="pre">&lt;id&gt;</span></code>.</dd>
<dt>nova aggregate-details &lt;id&gt;</dt>
<dd>Show details of the aggregate with id <code class="docutils literal"><span class="pre">&lt;id&gt;</span></code>.</dd>
<dt>nova aggregate-add-host &lt;id&gt; &lt;host&gt;</dt>
<dd>Add host with name <code class="docutils literal"><span class="pre">&lt;host&gt;</span></code> to aggregate with id <code class="docutils literal"><span class="pre">&lt;id&gt;</span></code>.</dd>
<dt>nova aggregate-remove-host &lt;id&gt; &lt;host&gt;</dt>
<dd>Remove the host with name <code class="docutils literal"><span class="pre">&lt;host&gt;</span></code> from the aggregate with id <code class="docutils literal"><span class="pre">&lt;id&gt;</span></code>.</dd>
<dt>nova aggregate-set-metadata &lt;id&gt; &lt;key=value&gt; [&lt;key=value&gt; ...]</dt>
<dd>Add or update metadata (key-value pairs) associated with the aggregate
with id <code class="docutils literal"><span class="pre">&lt;id&gt;</span></code>.</dd>
<dt>nova aggregate-update &lt;id&gt; &lt;name&gt; [&lt;availability_zone&gt;]</dt>
<dd>Update the name and availability zone (optional) for the aggregate.</dd>
<dt>nova host-list</dt>
<dd>List all hosts by service.</dd>
<dt>nova host-update &#8211;maintenance [enable | disable]</dt>
<dd>Put/resume host into/from maintenance.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Only administrators can access these commands. If you try to use
these commands and the user name and tenant that you use to access
the Compute service do not have the <code class="docutils literal"><span class="pre">admin</span></code> role or the
appropriate privileges, these errors occur:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">ERROR: Policy doesn&#39;t allow compute_extension:aggregates to be performed. (HTTP 403) (Request-ID: req-299fbff6-6729-4cef-93b2-e7e1f96b4864)</span>
</pre></div>
</div>
<div class="last highlight-console"><div class="highlight"><pre><span></span><span class="go">ERROR: Policy doesn&#39;t allow compute_extension:hosts to be performed. (HTTP 403) (Request-ID: req-ef2400f6-6776-4ea3-b6f1-7704085c27d1)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configure-scheduler-to-support-host-aggregates">
<h3>Configure scheduler to support host aggregates<a class="headerlink" href="#configure-scheduler-to-support-host-aggregates" title="Permalink to this headline">¶</a></h3>
<p>One common use case for host aggregates is when you want to support
scheduling instances to a subset of compute hosts because they have
a specific capability. For example, you may want to allow users to
request compute hosts that have SSD drives if they need access to
faster disk I/O, or access to compute hosts that have GPU cards to
take advantage of GPU-accelerated code.</p>
<p>To configure the scheduler to support host aggregates, the
<code class="docutils literal"><span class="pre">scheduler_default_filters</span></code> configuration option must contain the
<code class="docutils literal"><span class="pre">AggregateInstanceExtraSpecsFilter</span></code> in addition to the other
filters used by the scheduler. Add the following line to
<code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code> on the host that runs the <code class="docutils literal"><span class="pre">nova-scheduler</span></code>
service to enable host aggregates filtering, as well as the other
filters that are typically enabled:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">scheduler_default_filters</span><span class="o">=</span><span class="s">AggregateInstanceExtraSpecsFilter,RetryFilter,AvailabilityZoneFilter,RamFilter,ComputeFilter,ComputeCapabilitiesFilter,ImagePropertiesFilter,ServerGroupAntiAffinityFilter,ServerGroupAffinityFilter</span>
</pre></div>
</div>
</div>
<div class="section" id="example-specify-compute-hosts-with-ssds">
<h3>Example: Specify compute hosts with SSDs<a class="headerlink" href="#example-specify-compute-hosts-with-ssds" title="Permalink to this headline">¶</a></h3>
<p>This example configures the Compute service to enable users to request
nodes that have solid-state drives (SSDs). You create a <code class="docutils literal"><span class="pre">fast-io</span></code>
host aggregate in the <code class="docutils literal"><span class="pre">nova</span></code> availability zone and you add the
<code class="docutils literal"><span class="pre">ssd=true</span></code> key-value pair to the aggregate. Then, you add the
<code class="docutils literal"><span class="pre">node1</span></code>, and <code class="docutils literal"><span class="pre">node2</span></code> compute nodes to it.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova aggregate-create fast-io nova
<span class="go">+----+---------+-------------------+-------+----------+</span>
<span class="go">| Id | Name    | Availability Zone | Hosts | Metadata |</span>
<span class="go">+----+---------+-------------------+-------+----------+</span>
<span class="go">| 1  | fast-io | nova              |       |          |</span>
<span class="go">+----+---------+-------------------+-------+----------+</span>

<span class="gp">$</span> nova aggregate-set-metadata <span class="m">1</span> <span class="nv">ssd</span><span class="o">=</span><span class="nb">true</span>
<span class="go">+----+---------+-------------------+-------+-------------------+</span>
<span class="go">| Id | Name    | Availability Zone | Hosts | Metadata          |</span>
<span class="go">+----+---------+-------------------+-------+-------------------+</span>
<span class="go">| 1  | fast-io | nova              | []    | {u&#39;ssd&#39;: u&#39;true&#39;} |</span>
<span class="go">+----+---------+-------------------+-------+-------------------+</span>

<span class="gp">$</span> nova aggregate-add-host <span class="m">1</span> node1
<span class="go">+----+---------+-------------------+------------+-------------------+</span>
<span class="go">| Id | Name    | Availability Zone | Hosts      | Metadata          |</span>
<span class="go">+----+---------+-------------------+------------+-------------------+</span>
<span class="go">| 1  | fast-io | nova              | [u&#39;node1&#39;] | {u&#39;ssd&#39;: u&#39;true&#39;} |</span>
<span class="go">+----+---------+-------------------+------------+-------------------+</span>

<span class="gp">$</span> nova aggregate-add-host <span class="m">1</span> node2
<span class="go">+----+---------+-------------------+----------------------+-------------------+</span>
<span class="go">| Id | Name    | Availability Zone | Hosts                | Metadata          |</span>
<span class="go">+----+---------+-------------------+----------------------+-------------------+</span>
<span class="go">| 1  | fast-io | nova              | [u&#39;node1&#39;, u&#39;node2&#39;] | {u&#39;ssd&#39;: u&#39;true&#39;} |</span>
<span class="go">+----+---------+-------------------+----------------------+-------------------+</span>
</pre></div>
</div>
<p>Use the <strong class="command">nova flavor-create</strong> command to create the <code class="docutils literal"><span class="pre">ssd.large</span></code>
flavor called with an ID of 6, 8 GB of RAM, 80 GB root disk, and four vCPUs.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova flavor-create ssd.large <span class="m">6</span> <span class="m">8192</span> <span class="m">80</span> 4
<span class="go">+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+</span>
<span class="go">| ID | Name      | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |</span>
<span class="go">+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+</span>
<span class="go">| 6  | ssd.large | 8192      | 80   | 0         |      | 4     | 1.0         | True      |</span>
<span class="go">+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+</span>
</pre></div>
</div>
<p>Once the flavor is created, specify one or more key-value pairs that
match the key-value pairs on the host aggregates with scope
<code class="docutils literal"><span class="pre">aggregate_instance_extra_specs</span></code>. In this case, that is the
<code class="docutils literal"><span class="pre">aggregate_instance_extra_specs:ssd=true</span></code> key-value pair.
Setting a key-value pair on a flavor is done using the
<strong class="command">nova flavor-key</strong> command.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova flavor-key ssd.large <span class="nb">set</span> aggregate_instance_extra_specs:ssd<span class="o">=</span><span class="nb">true</span>
</pre></div>
</div>
<p>Once it is set, you should see the <code class="docutils literal"><span class="pre">extra_specs</span></code> property of the
<code class="docutils literal"><span class="pre">ssd.large</span></code> flavor populated with a key of <code class="docutils literal"><span class="pre">ssd</span></code> and a corresponding
value of <code class="docutils literal"><span class="pre">true</span></code>.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova flavor-show ssd.large
<span class="go">+----------------------------+--------------------------------------------------+</span>
<span class="go">| Property                   | Value                                            |</span>
<span class="go">+----------------------------+--------------------------------------------------+</span>
<span class="go">| OS-FLV-DISABLED:disabled   | False                                            |</span>
<span class="go">| OS-FLV-EXT-DATA:ephemeral  | 0                                                |</span>
<span class="go">| disk                       | 80                                               |</span>
<span class="go">| extra_specs                | {u&#39;aggregate_instance_extra_specs:ssd&#39;: u&#39;true&#39;} |</span>
<span class="go">| id                         | 6                                                |</span>
<span class="go">| name                       | ssd.large                                        |</span>
<span class="go">| os-flavor-access:is_public | True                                             |</span>
<span class="go">| ram                        | 8192                                             |</span>
<span class="go">| rxtx_factor                | 1.0                                              |</span>
<span class="go">| swap                       |                                                  |</span>
<span class="go">| vcpus                      | 4                                                |</span>
<span class="go">+----------------------------+--------------------------------------------------+</span>
</pre></div>
</div>
<p>Now, when a user requests an instance with the <code class="docutils literal"><span class="pre">ssd.large</span></code> flavor,
the scheduler only considers hosts with the <code class="docutils literal"><span class="pre">ssd=true</span></code> key-value pair.
In this example, these are <code class="docutils literal"><span class="pre">node1</span></code> and <code class="docutils literal"><span class="pre">node2</span></code>.</p>
</div>
<div class="section" id="xenserver-hypervisor-pools-to-support-live-migration">
<h3>XenServer hypervisor pools to support live migration<a class="headerlink" href="#xenserver-hypervisor-pools-to-support-live-migration" title="Permalink to this headline">¶</a></h3>
<p>When using the XenAPI-based hypervisor, the Compute service uses
host aggregates to manage XenServer Resource pools, which are
used in supporting live migration.</p>
</div>
</div>
<div class="section" id="configuration-options">
<h2>Configuration options<a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h2>
<p>The Compute scheduler configuration options are documented in the tables below.</p>
<table border="1" class="config-ref-table docutils" id="id19">
<span id="nova-scheduler"></span><caption><span class="caption-text">Description of scheduler configuration options</span><a class="headerlink" href="#id19" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Configuration option = Default value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>[DEFAULT]</strong></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">aggregate_image_properties_isolation_namespace</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td><p class="first">(String) Images and hosts can be configured so that certain images can only be scheduled to hosts in a particular aggregate. This is done with metadata values set on the host aggregate that are identified by beginning with the value of this option. If the host is part of an aggregate with such a metadata key, the image in the request spec must have the value of that metadata in its properties in order for the scheduler to consider the host as acceptable.</p>
<p>Valid values are strings.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect. Also note that this setting only affects scheduling if the &#8216;aggregate_image_properties_isolation&#8217; filter is enabled.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>aggregate_image_properties_isolation_separator</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">aggregate_image_properties_isolation_separator</span></code> = <code class="docutils literal"><span class="pre">.</span></code></td>
<td><p class="first">(String) When using the aggregate_image_properties_isolation filter, the relevant metadata keys are prefixed with the namespace defined in the aggregate_image_properties_isolation_namespace configuration option plus a separator. This option defines the separator to be used. It defaults to a period (&#8216;.&#8217;).</p>
<p>Valid values are strings.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect. Also note that this setting only affects scheduling if the &#8216;aggregate_image_properties_isolation&#8217; filter is enabled.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>aggregate_image_properties_isolation_namespace</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">baremetal_scheduler_default_filters</span></code> = <code class="docutils literal"><span class="pre">RetryFilter,</span> <span class="pre">AvailabilityZoneFilter,</span> <span class="pre">ComputeFilter,</span> <span class="pre">ComputeCapabilitiesFilter,</span> <span class="pre">ImagePropertiesFilter,</span> <span class="pre">ExactRamFilter,</span> <span class="pre">ExactDiskFilter,</span> <span class="pre">ExactCoreFilter</span></code></td>
<td><p class="first">(List) This option specifies the filters used for filtering baremetal hosts. The value should be a list of strings, with each string being the name of a filter class to be used. When used, they will be applied in order, so place your most restrictive filters first to make the filtering process more efficient.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>If the &#8216;scheduler_use_baremetal_filters&#8217; option is False, this option has no effect.</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">cpu_allocation_ratio</span></code> = <code class="docutils literal"><span class="pre">0.0</span></code></td>
<td><p class="first">(Floating point) This option helps you specify virtual CPU to physical CPU allocation ratio which affects all CPU filters.</p>
<p>This configuration specifies ratio for CoreFilter which can be set per compute node. For AggregateCoreFilter, it will fall back to this configuration value if no per-aggregate setting is found.</p>
<p>Possible values:</p>
<ul class="simple">
<li>Any valid positive integer or float value</li>
<li>Default value is 0.0</li>
</ul>
<p class="last">NOTE: This can be set per-compute, or if set to 0.0, the value set on the scheduler node(s) or compute node(s) will be used and defaulted to 16.0&#8217;.</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">disk_allocation_ratio</span></code> = <code class="docutils literal"><span class="pre">0.0</span></code></td>
<td><p class="first">(Floating point) This option helps you specify virtual disk to physical disk allocation ratio used by the disk_filter.py script to determine if a host has sufficient disk space to fit a requested instance.</p>
<p>A ratio greater than 1.0 will result in over-subscription of the available physical disk, which can be useful for more efficiently packing instances created with images that do not use the entire virtual disk, such as sparse or compressed images. It can be set to a value between 0.0 and 1.0 in order to preserve a percentage of the disk for uses other than instances.</p>
<p>Possible values:</p>
<ul class="simple">
<li>Any valid positive integer or float value</li>
<li>Default value is 0.0</li>
</ul>
<p class="last">NOTE: This can be set per-compute, or if set to 0.0, the value set on the scheduler node(s) or compute node(s) will be used and defaulted to 1.0&#8217;.</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">disk_weight_multiplier</span></code> = <code class="docutils literal"><span class="pre">1.0</span></code></td>
<td>(Floating point) Multiplier used for weighing free disk space. Negative numbers mean to stack vs spread.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">io_ops_weight_multiplier</span></code> = <code class="docutils literal"><span class="pre">-1.0</span></code></td>
<td><p class="first">(Floating point) This option determines how hosts with differing workloads are weighed. Negative values, such as the default, will result in the scheduler preferring hosts with lighter workloads whereas positive values will prefer hosts with heavier workloads. Another way to look at it is that positive values for this option will tend to schedule instances onto hosts that are already busy, while negative values will tend to distribute the workload across more hosts. The absolute value, whether positive or negative, controls how strong the io_ops weigher is relative to other weighers.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect. Also note that this setting only affects scheduling if the &#8216;io_ops&#8217; weigher is enabled.</p>
<p>Valid values are numeric, either integer or float.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">isolated_hosts</span></code> =</td>
<td><p class="first">(List) If there is a need to restrict some images to only run on certain designated hosts, list those host names here.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect. Also note that this setting only affects scheduling if the &#8216;IsolatedHostsFilter&#8217; filter is enabled.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>scheduler/isolated_images scheduler/restrict_isolated_hosts_to_isolated_images</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">isolated_images</span></code> =</td>
<td><p class="first">(List) If there is a need to restrict some images to only run on certain designated hosts, list those image UUIDs here.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect. Also note that this setting only affects scheduling if the &#8216;IsolatedHostsFilter&#8217; filter is enabled.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>scheduler/isolated_hosts scheduler/restrict_isolated_hosts_to_isolated_images</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">max_instances_per_host</span></code> = <code class="docutils literal"><span class="pre">50</span></code></td>
<td><p class="first">(Integer) If you need to limit the number of instances on any given host, set this option to the maximum number of instances you want to allow. The num_instances_filter will reject any host that has at least as many instances as this option&#8217;s value.</p>
<p>Valid values are positive integers; setting it to zero will cause all hosts to be rejected if the num_instances_filter is active.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect. Also note that this setting only affects scheduling if the &#8216;num_instances_filter&#8217; filter is enabled.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">max_io_ops_per_host</span></code> = <code class="docutils literal"><span class="pre">8</span></code></td>
<td><p class="first">(Integer) This setting caps the number of instances on a host that can be actively performing IO (in a build, resize, snapshot, migrate, rescue, or unshelve task state) before that host becomes ineligible to build new instances.</p>
<p>Valid values are positive integers: 1 or greater.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect. Also note that this setting only affects scheduling if the &#8216;io_ops_filter&#8217; filter is enabled.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ram_allocation_ratio</span></code> = <code class="docutils literal"><span class="pre">0.0</span></code></td>
<td><p class="first">(Floating point) This option helps you specify virtual RAM to physical RAM allocation ratio which affects all RAM filters.</p>
<p>This configuration specifies ratio for RamFilter which can be set per compute node. For AggregateRamFilter, it will fall back to this configuration value if no per-aggregate setting found.</p>
<p>Possible values:</p>
<ul class="simple">
<li>Any valid positive integer or float value</li>
<li>Default value is 0.0</li>
</ul>
<p class="last">NOTE: This can be set per-compute, or if set to 0.0, the value set on the scheduler node(s) or compute node(s) will be used and defaulted to 1.5.</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">ram_weight_multiplier</span></code> = <code class="docutils literal"><span class="pre">1.0</span></code></td>
<td><p class="first">(Floating point) This option determines how hosts with more or less available RAM are weighed. A positive value will result in the scheduler preferring hosts with more available RAM, and a negative number will result in the scheduler preferring hosts with less available RAM. Another way to look at it is that positive values for this option will tend to spread instances across many hosts, while negative values will tend to fill up (stack) hosts as much as possible before scheduling to a less-used host. The absolute value, whether positive or negative, controls how strong the RAM weigher is relative to other weighers.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect. Also note that this setting only affects scheduling if the &#8216;ram&#8217; weigher is enabled.</p>
<p>Valid values are numeric, either integer or float.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">reserved_host_disk_mb</span></code> = <code class="docutils literal"><span class="pre">0</span></code></td>
<td><p class="first">(Integer) Amount of disk resources in MB to make them always available to host. The disk usage gets reported back to the scheduler from nova-compute running on the compute nodes. To prevent the disk resources from being considered as available, this option can be used to reserve disk space for that host.</p>
<p>Possible values:</p>
<ul class="last simple">
<li>Any positive integer representing amount of disk in MB to reserve for the host.</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">reserved_host_memory_mb</span></code> = <code class="docutils literal"><span class="pre">512</span></code></td>
<td><p class="first">(Integer) Amount of memory in MB to reserve for the host so that it is always available to host processes. The host resources usage is reported back to the scheduler continuously from nova-compute running on the compute node. To prevent the host memory from being considered as available, this option is used to reserve memory for the host.</p>
<p>Possible values:</p>
<ul class="last simple">
<li>Any positive integer representing amount of memory in MB to reserve for the host.</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">reserved_huge_pages</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td><p class="first">(Unknown) Reserves a number of huge/large memory pages per NUMA host cells</p>
<p>Possible values:</p>
<ul class="simple">
<li>A list of valid key=value which reflect NUMA node ID, page size (Default unit is KiB) and number of pages to be reserved.</li>
</ul>
<blockquote class="last">
<div><p>reserved_huge_pages = node:0,size:2048,count:64 reserved_huge_pages = node:1,size:1GB,count:1</p>
<p>In this example we are reserving on NUMA node 0 64 pages of 2MiB and on NUMA node 1 1 page of 1GiB.</p>
</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">restrict_isolated_hosts_to_isolated_images</span></code> = <code class="docutils literal"><span class="pre">True</span></code></td>
<td><p class="first">(Boolean) This setting determines if the scheduler&#8217;s isolated_hosts filter will allow non-isolated images on a host designated as an isolated host. When set to True (the default), non-isolated images will not be allowed to be built on isolated hosts. When False, non-isolated images can be built on both isolated and non-isolated hosts alike.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect. Also note that this setting only affects scheduling if the &#8216;IsolatedHostsFilter&#8217; filter is enabled. Even then, this option doesn&#8217;t affect the behavior of requests for isolated images, which will <em>always</em> be restricted to isolated hosts.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>scheduler/isolated_images scheduler/isolated_hosts</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">scheduler_available_filters</span></code> = <code class="docutils literal"><span class="pre">['nova.scheduler.filters.all_filters']</span></code></td>
<td><p class="first">(Multi-valued) This is an unordered list of the filter classes the Nova scheduler may apply. Only the filters specified in the &#8216;scheduler_default_filters&#8217; option will be used, but any filter appearing in that option must also be included in this list.</p>
<p>By default, this is set to all filters that are included with Nova. If you wish to change this, replace this with a list of strings, where each element is the path to a filter.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>scheduler_default_filters</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scheduler_default_filters</span></code> = <code class="docutils literal"><span class="pre">RetryFilter,</span> <span class="pre">AvailabilityZoneFilter,</span> <span class="pre">RamFilter,</span> <span class="pre">DiskFilter,</span> <span class="pre">ComputeFilter,</span> <span class="pre">ComputeCapabilitiesFilter,</span> <span class="pre">ImagePropertiesFilter,</span> <span class="pre">ServerGroupAntiAffinityFilter,</span> <span class="pre">ServerGroupAffinityFilter</span></code></td>
<td><p class="first">(List) This option is the list of filter class names that will be used for filtering hosts. The use of &#8216;default&#8217; in the name of this option implies that other filters may sometimes be used, but that is not the case. These filters will be applied in the order they are listed, so place your most restrictive filters first to make the filtering process more efficient.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>All of the filters in this option <em>must</em> be present in the &#8216;scheduler_available_filters&#8217; option, or a SchedulerHostFilterNotFound exception will be raised.</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">scheduler_driver</span></code> = <code class="docutils literal"><span class="pre">filter_scheduler</span></code></td>
<td><p class="first">(String) The class of the driver used by the scheduler. This should be chosen from one of the entrypoints under the namespace &#8216;nova.scheduler.driver&#8217; of file &#8216;setup.cfg&#8217;. If nothing is specified in this option, the &#8216;filter_scheduler&#8217; is used.</p>
<p>This option also supports deprecated full Python path to the class to be used. For example, &#8220;nova.scheduler.filter_scheduler.FilterScheduler&#8221;. But note: this support will be dropped in the N Release.</p>
<p>Other options are:</p>
<ul class="simple">
<li>&#8216;caching_scheduler&#8217; which aggressively caches the system state for better individual scheduler performance at the risk of more retries when running multiple schedulers.</li>
<li>&#8216;chance_scheduler&#8217; which simply picks a host at random.</li>
<li>&#8216;fake_scheduler&#8217; which is used for testing.</li>
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scheduler_driver_task_period</span></code> = <code class="docutils literal"><span class="pre">60</span></code></td>
<td><p class="first">(Integer) This value controls how often (in seconds) to run periodic tasks in the scheduler. The specific tasks that are run for each period are determined by the particular scheduler being used.</p>
<p>If this is larger than the nova-service &#8216;service_down_time&#8217; setting, Nova may report the scheduler service as down. This is because the scheduler driver is responsible for sending a heartbeat and it will only do that as often as this option allows. As each scheduler can work a little differently than the others, be sure to test this with your selected scheduler.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div><code class="docutils literal"><span class="pre">nova-service</span> <span class="pre">service_down_time</span></code></div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">scheduler_host_manager</span></code> = <code class="docutils literal"><span class="pre">host_manager</span></code></td>
<td><p class="first">(String) The scheduler host manager to use, which manages the in-memory picture of the hosts that the scheduler uses.</p>
<p>The option value should be chosen from one of the entrypoints under the namespace &#8216;nova.scheduler.host_manager&#8217; of file &#8216;setup.cfg&#8217;. For example, &#8216;host_manager&#8217; is the default setting. Aside from the default, the only other option as of the Mitaka release is &#8216;ironic_host_manager&#8217;, which should be used if you&#8217;re using Ironic to provision bare-metal instances.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scheduler_host_subset_size</span></code> = <code class="docutils literal"><span class="pre">1</span></code></td>
<td><p class="first">(Integer) New instances will be scheduled on a host chosen randomly from a subset of the N best hosts, where N is the value set by this option. Valid values are 1 or greater. Any value less than one will be treated as 1.</p>
<p>Setting this to a value greater than 1 will reduce the chance that multiple scheduler processes handling similar requests will select the same host, creating a potential race condition. By selecting a host randomly from the N hosts that best fit the request, the chance of a conflict is reduced. However, the higher you set this value, the less optimal the chosen host may be for a given request.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">scheduler_instance_sync_interval</span></code> = <code class="docutils literal"><span class="pre">120</span></code></td>
<td>(Integer) Waiting time interval (seconds) between sending the scheduler a list of current instance UUIDs to verify that its view of instances is in sync with nova. If the CONF option <cite>scheduler_tracks_instance_changes</cite> is False, changing this option will have no effect.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scheduler_json_config_location</span></code> =</td>
<td><p class="first">(String) The absolute path to the scheduler configuration JSON file, if any. This file location is monitored by the scheduler for changes and reloads it if needed. It is converted from JSON to a Python data structure, and passed into the filtering and weighing functions of the scheduler, which can use it for dynamic configuration.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">scheduler_manager</span></code> = <code class="docutils literal"><span class="pre">nova.scheduler.manager.SchedulerManager</span></code></td>
<td>(String) DEPRECATED: Full class name for the Manager for scheduler</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scheduler_max_attempts</span></code> = <code class="docutils literal"><span class="pre">3</span></code></td>
<td><p class="first">(Integer) This is the maximum number of attempts that will be made to schedule an instance before it is assumed that the failures aren&#8217;t due to normal occasional race conflicts, but rather some other problem. When this is reached a MaxRetriesExceeded exception is raised, and the instance is set to an error state.</p>
<p>Valid values are positive integers (1 or greater).</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">scheduler_topic</span></code> = <code class="docutils literal"><span class="pre">scheduler</span></code></td>
<td><p class="first">(String) This is the message queue topic that the scheduler &#8216;listens&#8217; on. It is used when the scheduler service is started up to configure the queue, and whenever an RPC call to the scheduler is made. There is almost never any reason to ever change this value.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scheduler_tracks_instance_changes</span></code> = <code class="docutils literal"><span class="pre">True</span></code></td>
<td><p class="first">(Boolean) The scheduler may need information about the instances on a host in order to evaluate its filters and weighers. The most common need for this information is for the (anti-)affinity filters, which need to choose a host based on the instances already running on a host.</p>
<p>If the configured filters and weighers do not need this information, disabling this option will improve performance. It may also be disabled when the tracking overhead proves too heavy, although this will cause classes requiring host usage data to query the database on each request instead.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">scheduler_use_baremetal_filters</span></code> = <code class="docutils literal"><span class="pre">False</span></code></td>
<td><p class="first">(Boolean) Set this to True to tell the nova scheduler that it should use the filters specified in the &#8216;baremetal_scheduler_default_filters&#8217; option. If you are not scheduling baremetal nodes, leave this at the default setting of False.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>If this option is set to True, then the filters specified in the &#8216;baremetal_scheduler_default_filters&#8217; are used instead of the filters specified in &#8216;scheduler_default_filters&#8217;.</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scheduler_weight_classes</span></code> = <code class="docutils literal"><span class="pre">nova.scheduler.weights.all_weighers</span></code></td>
<td><p class="first">(List) This is a list of weigher class names. Only hosts which pass the filters are weighed. The weight for any host starts at 0, and the weighers order these hosts by adding to or subtracting from the weight assigned by the previous weigher. Weights may become negative.</p>
<p>An instance will be scheduled to one of the N most-weighted hosts, where N is &#8216;scheduler_host_subset_size&#8217;.</p>
<p>By default, this is set to all weighers that are included with Nova. If you wish to change this, replace this with a list of strings, where each element is the path to a weigher.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>None</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">soft_affinity_weight_multiplier</span></code> = <code class="docutils literal"><span class="pre">1.0</span></code></td>
<td>(Floating point) Multiplier used for weighing hosts for group soft-affinity. Only a positive value is meaningful. Negative means that the behavior will change to the opposite, which is soft-anti-affinity.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">soft_anti_affinity_weight_multiplier</span></code> = <code class="docutils literal"><span class="pre">1.0</span></code></td>
<td>(Floating point) Multiplier used for weighing hosts for group soft-anti-affinity. Only a positive value is meaningful. Negative means that the behavior will change to the opposite, which is soft-affinity.</td>
</tr>
<tr class="row-even"><td><strong>[cells]</strong></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">ram_weight_multiplier</span></code> = <code class="docutils literal"><span class="pre">10.0</span></code></td>
<td><p class="first">(Floating point) Ram weight multiplier</p>
<p>Multiplier used for weighing ram. Negative numbers indicate that Compute should stack VMs on one host instead of spreading out new VMs to more hosts in the cell.</p>
<p>Possible values:</p>
<ul class="last simple">
<li>Numeric multiplier</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">scheduler_filter_classes</span></code> = <code class="docutils literal"><span class="pre">nova.cells.filters.all_filters</span></code></td>
<td><p class="first">(List) Scheduler filter classes</p>
<p>Filter classes the cells scheduler should use. An entry of &#8220;nova.cells.filters.all_filters&#8221; maps to all cells filters included with nova. As of the Mitaka release the following filter classes are available:</p>
<p>Different cell filter: A scheduler hint of &#8216;different_cell&#8217; with a value of a full cell name may be specified to route a build away from a particular cell.</p>
<p>Image properties filter: Image metadata named &#8216;hypervisor_version_requires&#8217; with a version specification may be specified to ensure the build goes to a cell which has hypervisors of the required version. If either the version requirement on the image or the hypervisor capability of the cell is not present, this filter returns without filtering out the cells.</p>
<p>Target cell filter: A scheduler hint of &#8216;target_cell&#8217; with a value of a full cell name may be specified to route a build to a particular cell. No error handling is done as there&#8217;s no way to know whether the full path is a valid.</p>
<p class="last">As an admin user, you can also add a filter that directs builds to a particular cell.</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scheduler_retries</span></code> = <code class="docutils literal"><span class="pre">10</span></code></td>
<td><p class="first">(Integer) Scheduler retries</p>
<p>How many retries when no cells are available. Specifies how many times the scheduler tries to launch a new instance when no cells are available.</p>
<p>Possible values:</p>
<ul class="simple">
<li>Positive integer value</li>
</ul>
<p>Related options:</p>
<ul class="last simple">
<li>This value is used with the <code class="docutils literal"><span class="pre">scheduler_retry_delay</span></code> value while retrying to find a suitable cell.</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">scheduler_retry_delay</span></code> = <code class="docutils literal"><span class="pre">2</span></code></td>
<td><p class="first">(Integer) Scheduler retry delay</p>
<p>Specifies the delay (in seconds) between scheduling retries when no cell can be found to place the new instance on. When the instance could not be scheduled to a cell after <code class="docutils literal"><span class="pre">scheduler_retries</span></code> in combination with <code class="docutils literal"><span class="pre">scheduler_retry_delay</span></code>, then the scheduling of the instance failed.</p>
<p>Possible values:</p>
<ul class="simple">
<li>Time in seconds.</li>
</ul>
<p>Related options:</p>
<ul class="last simple">
<li>This value is used with the <code class="docutils literal"><span class="pre">scheduler_retries</span></code> value while retrying to find a suitable cell.</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scheduler_weight_classes</span></code> = <code class="docutils literal"><span class="pre">nova.cells.weights.all_weighers</span></code></td>
<td><p class="first">(List) Scheduler weight classes</p>
<p>Weigher classes the cells scheduler should use. An entry of &#8220;nova.cells.weights.all_weighers&#8221; maps to all cell weighers included with nova. As of the Mitaka release the following weight classes are available:</p>
<p>mute_child: Downgrades the likelihood of child cells being chosen for scheduling requests, which haven&#8217;t sent capacity or capability updates in a while. Options include mute_weight_multiplier (multiplier for mute children; value should be negative).</p>
<p>ram_by_instance_type: Select cells with the most RAM capacity for the instance type being requested. Because higher weights win, Compute returns the number of available units for the instance type requested. The ram_weight_multiplier option defaults to 10.0 that adds to the weight by a factor of 10. Use a negative number to stack VMs on one host instead of spreading out new VMs to more hosts in the cell.</p>
<p class="last">weight_offset: Allows modifying the database to weight a particular cell. The highest weight will be the first cell to be scheduled for launching an instance. When the weight_offset of a cell is set to 0, it is unlikely to be picked but it could be picked if other cells have a lower weight, like if they&#8217;re full. And when the weight_offset is set to a very high value (for example, &#8216;999999999999999&#8217;), it is likely to be picked if another cell do not have a higher weight.</p>
</td>
</tr>
<tr class="row-even"><td><strong>[metrics]</strong></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">required</span></code> = <code class="docutils literal"><span class="pre">True</span></code></td>
<td><p class="first">(Boolean) This setting determines how any unavailable metrics are treated. If this option is set to True, any hosts for which a metric is unavailable will raise an exception, so it is recommended to also use the MetricFilter to filter out those hosts before weighing.</p>
<p>When this option is False, any metric being unavailable for a host will set the host weight to &#8216;weight_of_unavailable&#8217;.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>weight_of_unavailable</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">weight_multiplier</span></code> = <code class="docutils literal"><span class="pre">1.0</span></code></td>
<td><p class="first">(Floating point) When using metrics to weight the suitability of a host, you can use this option to change how the calculated weight influences the weight assigned to a host as follows:</p>
<ul class="simple">
<li>Greater than 1.0: increases the effect of the metric on overall weight.</li>
<li>Equal to 1.0: No change to the calculated weight.</li>
<li>Less than 1.0, greater than 0: reduces the effect of the metric on overall weight.</li>
<li>0: The metric value is ignored, and the value of the &#8216;weight_of_unavailable&#8217; option is returned instead.</li>
<li>Greater than -1.0, less than 0: the effect is reduced and reversed.</li>
<li>-1.0: the effect is reversed</li>
<li>Less than -1.0: the effect is increased proportionally and reversed.</li>
</ul>
<p>Valid values are numeric, either integer or float.</p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>weight_of_unavailable</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">weight_of_unavailable</span></code> = <code class="docutils literal"><span class="pre">-10000.0</span></code></td>
<td><p class="first">(Floating point) When any of the following conditions are met, this value will be used in place of any actual metric value:</p>
<ul class="simple">
<li>One of the metrics named in &#8216;weight_setting&#8217; is not available for a host, and the value of &#8216;required&#8217; is False.</li>
<li>The ratio specified for a metric in &#8216;weight_setting&#8217; is 0.</li>
<li>The &#8216;weight_multiplier&#8217; option is set to 0.</li>
</ul>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<blockquote class="last">
<div>weight_setting required weight_multiplier</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">weight_setting</span></code> =</td>
<td><p class="first">(List) This setting specifies the metrics to be weighed and the relative ratios for each metric. This should be a single string value, consisting of a series of one or more &#8216;name=ratio&#8217; pairs, separated by commas, where &#8216;name&#8217; is the name of the metric to be weighed, and &#8216;ratio&#8217; is the relative weight for that metric.</p>
<p>Note that if the ratio is set to 0, the metric value is ignored, and instead the weight will be set to the value of the &#8216;weight_of_unavailable&#8217; option.</p>
<p>As an example, let&#8217;s consider the case where this option is set to:</p>
<p><code class="docutils literal"><span class="pre">name1=1.0,</span> <span class="pre">name2=-1.3</span></code></p>
<p>The final weight will be:</p>
<p><code class="docutils literal"><span class="pre">(name1.value</span> <span class="pre">*</span> <span class="pre">1.0)</span> <span class="pre">+</span> <span class="pre">(name2.value</span> <span class="pre">*</span> <span class="pre">-1.3)</span></code></p>
<p>This option is only used by the FilterScheduler and its subclasses; if you use a different scheduler, this option has no effect.</p>
<ul class="simple">
<li>Related options:</li>
</ul>
<p class="last">weight_of_unavailable</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="hypervisor-virtuozzo.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Virtuozzo"></i></a>
          
          
            <a href="cells.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Cells"></i></a>
          
            <a id="logABugLink3" href="#" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2016-12-31 09:03</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org/" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='http://docs.openstack.org/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index-2.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../config-overview.html">OpenStack configuration overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common-configurations.html">Common configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../application-catalog.html">Application Catalog service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bare-metal.html">Bare Metal service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block-storage.html">Block Storage service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../clustering.html">Clustering service</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../compute.html">Compute service</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config-options.html">The full set of available options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tables/conf-changes/nova.html">New, updated, and deprecated options in Newton for Compute</a></li>
<li class="toctree-l2"><a class="reference internal" href="nova-conf.html">Overview of nova.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">Compute API configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="resize.html">Configure resize</a></li>
<li class="toctree-l2"><a class="reference internal" href="database-connections.html">Database configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="fibre-channel.html">Fibre Channel support in Compute</a></li>
<li class="toctree-l2"><a class="reference internal" href="iscsi-offload.html">iSCSI interface and offload support in Compute</a></li>
<li class="toctree-l2"><a class="reference internal" href="hypervisors.html">Hypervisors</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Compute schedulers</a></li>
<li class="toctree-l2"><a class="reference internal" href="cells.html">Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="conductor.html">Conductor</a></li>
<li class="toctree-l2"><a class="reference internal" href="logs.html">Compute log files</a></li>
<li class="toctree-l2"><a class="reference internal" href="nova-conf-samples.html">Example nova.conf configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="samples/index.html">Compute service sample configuration files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-processing.html">Data Processing service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../database.html">Database service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../identity.html">Identity service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../image.html">Image service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../message.html">Message service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking.html">Networking service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../object-storage.html">Object Storage service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orchestration.html">Orchestration service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shared-file-systems.html">Shared File Systems service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../telemetry.html">Telemetry service</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../policy-json-file.html">The policy.json file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../firewalls-default-ports.html">Firewalls and default ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org/">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org/">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org/">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com/" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-1.11.3.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "compute/schedulers" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/config-reference/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 8769323640f01e3e92c0a6af672b0e6fab8a4af7";
        var bugProject = "openstack-manuals";
        var bugTitle = "Compute schedulers in Configuration Reference";
    var fieldTags = "config-reference";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2016-12-31 09:03";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>

<!-- Mirrored from docs.openstack.org/newton/config-reference/compute/schedulers.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Jan 2017 10:24:39 GMT -->
</html>