<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  
<!-- Mirrored from docs.openstack.org/newton/config-reference/compute/cells.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Jan 2017 09:29:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Cells</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../../../../maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">
<link href="../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="../_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="http://docs.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org/">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org/">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://ask.openstack.org/">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/videos/summits">Summit Videos</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
    <h2>Cells</h2>
  </div>
  <div class="docs-actions">
    
    <a href="schedulers.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Compute schedulers"></i></a>
    
    
    <a href="conductor.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Conductor"></i></a>
    
    <a id="logABugLink1" href="#" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2016-12-31 09:03</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../index-2.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Cells</a><ul>
<li><a class="reference internal" href="#cell-configuration-options">Cell configuration options</a></li>
<li><a class="reference internal" href="#configure-the-api-top-level-cell">Configure the API (top-level) cell</a></li>
<li><a class="reference internal" href="#configure-the-child-cells">Configure the child cells</a></li>
<li><a class="reference internal" href="#configure-the-database-in-each-cell">Configure the database in each cell</a></li>
<li><a class="reference internal" href="#cell-scheduling-configuration">Cell scheduling configuration</a></li>
<li><a class="reference internal" href="#optional-cell-configuration">Optional cell configuration</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="cells">
<h1>Cells<a class="headerlink" href="#cells" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">Cells</span></code> functionality enables you to scale an OpenStack Compute
cloud in a more distributed fashion without having to use complicated
technologies like database and message queue clustering.
It supports very large deployments.</p>
<p>When this functionality is enabled, the hosts in an OpenStack Compute
cloud are partitioned into groups called cells.
Cells are configured as a tree. The top-level cell should have a host
that runs a <code class="docutils literal"><span class="pre">nova-api</span></code> service, but no <code class="docutils literal"><span class="pre">nova-compute</span></code> services.
Each child cell should run all of the typical <code class="docutils literal"><span class="pre">nova-*</span></code> services in
a regular Compute cloud except for <code class="docutils literal"><span class="pre">nova-api</span></code>. You can think of
cells as a normal Compute deployment in that each cell has its own
database server and message queue broker.</p>
<p>The <code class="docutils literal"><span class="pre">nova-cells</span></code> service handles communication between cells and
selects cells for new instances. This service is required for every
cell. Communication between cells is pluggable, and currently the
only option is communication through RPC.</p>
<p>Cells scheduling is separate from host scheduling.
<code class="docutils literal"><span class="pre">nova-cells</span></code> first picks a cell. Once a cell is selected and the
new build request reaches its <code class="docutils literal"><span class="pre">nova-cells</span></code> service, it is sent
over to the host scheduler in that cell and the build proceeds as
it would have without cells.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Cell functionality is currently considered experimental.</p>
</div>
<div class="section" id="cell-configuration-options">
<h2>Cell configuration options<a class="headerlink" href="#cell-configuration-options" title="Permalink to this headline">¶</a></h2>
<p>Cells are disabled by default. All cell-related configuration
options appear in the <code class="docutils literal"><span class="pre">[cells]</span></code> section in <code class="docutils literal"><span class="pre">nova.conf</span></code>.
The following cell-related options are currently supported:</p>
<dl class="docutils">
<dt>enable</dt>
<dd>Set to <code class="docutils literal"><span class="pre">True</span></code> to turn on cell functionality. Default is <code class="docutils literal"><span class="pre">false</span></code>.</dd>
<dt>name</dt>
<dd>Name of the current cell. Must be unique for each cell.</dd>
<dt>capabilities</dt>
<dd>List of arbitrary <code class="docutils literal"><span class="pre">key=value</span></code> pairs defining capabilities of the current
cell. Values include <code class="docutils literal"><span class="pre">hypervisor=xenserver;kvm,os=linux;windows</span></code>.</dd>
<dt>call_timeout</dt>
<dd>How long in seconds to wait for replies from calls between cells.</dd>
<dt>scheduler_filter_classes</dt>
<dd>Filter classes that the cells scheduler should use.
By default, uses <code class="docutils literal"><span class="pre">nova.cells.filters.all_filters</span></code> to map to
all cells filters included with Compute.</dd>
<dt>scheduler_weight_classes</dt>
<dd>Weight classes that the scheduler for cells uses. By default,
uses <code class="docutils literal"><span class="pre">nova.cells.weights.all_weighers</span></code> to map to all cells
weight algorithms included with Compute.</dd>
<dt>ram_weight_multiplier</dt>
<dd>Multiplier used to weight RAM. Negative numbers indicate that
Compute should stack VMs on one host instead of spreading out
new VMs to more hosts in the cell. The default value is 10.0.</dd>
</dl>
</div>
<div class="section" id="configure-the-api-top-level-cell">
<h2>Configure the API (top-level) cell<a class="headerlink" href="#configure-the-api-top-level-cell" title="Permalink to this headline">¶</a></h2>
<p>The cell type must be changed in the API cell so that requests can
be proxied through nova-cells down to the correct cell properly.
Edit the <code class="docutils literal"><span class="pre">nova.conf</span></code> file in the API cell, and specify <code class="docutils literal"><span class="pre">api</span></code>
in the <code class="docutils literal"><span class="pre">cell_type</span></code> key:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span>[DEFAULT]
compute_api_class=nova.compute.cells_api.ComputeCellsAPI
...

[cells]
cell_type= api
</pre></div>
</div>
</div>
<div class="section" id="configure-the-child-cells">
<h2>Configure the child cells<a class="headerlink" href="#configure-the-child-cells" title="Permalink to this headline">¶</a></h2>
<p>Edit the <code class="docutils literal"><span class="pre">nova.conf</span></code> file in the child cells, and specify
<code class="docutils literal"><span class="pre">compute</span></code> in the <code class="docutils literal"><span class="pre">cell_type</span></code> key:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="c1"># Disable quota checking in child cells. Let API cell do it exclusively.</span>
<span class="na">quota_driver</span><span class="o">=</span><span class="s">nova.quota.NoopQuotaDriver</span>

<span class="k">[cells]</span>
<span class="na">cell_type</span> <span class="o">=</span> <span class="s">compute</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-the-database-in-each-cell">
<h2>Configure the database in each cell<a class="headerlink" href="#configure-the-database-in-each-cell" title="Permalink to this headline">¶</a></h2>
<p>Before bringing the services online, the database in each cell
needs to be configured with information about related cells.
In particular, the API cell needs to know about its immediate
children, and the child cells must know about their immediate agents.
The information needed is the <code class="docutils literal"><span class="pre">RabbitMQ</span></code> server credentials
for the particular cell.</p>
<p>Use the <strong class="command">nova-manage cell create</strong> command to add this
information to the database in each cell:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> nova-manage cell create -h
<span class="go">usage: nova-manage cell create [-h] [--name &lt;name&gt;]</span>
<span class="go">                               [--cell_type &lt;parent|api|child|compute&gt;]</span>
<span class="go">                               [--username &lt;username&gt;] [--password &lt;password&gt;]</span>
<span class="go">                               [--broker_hosts &lt;broker_hosts&gt;]</span>
<span class="go">                               [--hostname &lt;hostname&gt;] [--port &lt;number&gt;]</span>
<span class="go">                               [--virtual_host &lt;virtual_host&gt;]</span>
<span class="go">                               [--woffset &lt;float&gt;] [--wscale &lt;float&gt;]</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  --name &lt;name&gt;         Name for the new cell</span>
<span class="go">  --cell_type &lt;parent|api|child|compute&gt;</span>
<span class="go">                        Whether the cell is parent/api or child/compute</span>
<span class="go">  --username &lt;username&gt;</span>
<span class="go">                        Username for the message broker in this cell</span>
<span class="go">  --password &lt;password&gt;</span>
<span class="go">                        Password for the message broker in this cell</span>
<span class="go">  --broker_hosts &lt;broker_hosts&gt;</span>
<span class="go">                        Comma separated list of message brokers in this cell.</span>
<span class="go">                        Each Broker is specified as hostname:port with both</span>
<span class="go">                        mandatory. This option overrides the --hostname and</span>
<span class="go">                        --port options (if provided).</span>
<span class="go">  --hostname &lt;hostname&gt;</span>
<span class="go">                        Address of the message broker in this cell</span>
<span class="go">  --port &lt;number&gt;       Port number of the message broker in this cell</span>
<span class="go">  --virtual_host &lt;virtual_host&gt;</span>
<span class="go">                        The virtual host of the message broker in this cell</span>
<span class="go">  --woffset &lt;float&gt;</span>
<span class="go">  --wscale &lt;float&gt;</span>
</pre></div>
</div>
<p>As an example, assume an API cell named <code class="docutils literal"><span class="pre">api</span></code> and a child
cell named <code class="docutils literal"><span class="pre">cell1</span></code>.</p>
<p>Within the <code class="docutils literal"><span class="pre">api</span></code> cell, specify the following <code class="docutils literal"><span class="pre">RabbitMQ</span></code>
server information:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">rabbit_host</span><span class="o">=</span><span class="s">10.0.0.10</span>
<span class="na">rabbit_port</span><span class="o">=</span><span class="s">5672</span>
<span class="na">rabbit_username</span><span class="o">=</span><span class="s">api_user</span>
<span class="na">rabbit_password</span><span class="o">=</span><span class="s">api_passwd</span>
<span class="na">rabbit_virtual_host</span><span class="o">=</span><span class="s">api_vhost</span>
</pre></div>
</div>
<p>Within the <code class="docutils literal"><span class="pre">cell1</span></code> child cell, specify the following
<code class="docutils literal"><span class="pre">RabbitMQ</span></code> server information:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">rabbit_host</span><span class="o">=</span><span class="s">10.0.1.10</span>
<span class="na">rabbit_port</span><span class="o">=</span><span class="s">5673</span>
<span class="na">rabbit_username</span><span class="o">=</span><span class="s">cell1_user</span>
<span class="na">rabbit_password</span><span class="o">=</span><span class="s">cell1_passwd</span>
<span class="na">rabbit_virtual_host</span><span class="o">=</span><span class="s">cell1_vhost</span>
</pre></div>
</div>
<p>You can run this in the API cell as root:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> nova-manage cell create --name cell1 --cell_type child <span class="se">\</span>
<span class="go">  --username cell1_user --password cell1_passwd --hostname 10.0.1.10 \</span>
<span class="go">  --port 5673 --virtual_host cell1_vhost --woffset 1.0 --wscale 1.0</span>
</pre></div>
</div>
<p>Repeat the previous steps for all child cells.</p>
<p>In the child cell, run the following, as root:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> nova-manage cell create --name api --cell_type parent <span class="se">\</span>
<span class="go">  --username api_user --password api_passwd --hostname 10.0.0.10 \</span>
<span class="go">  --port 5672 --virtual_host api_vhost --woffset 1.0 --wscale 1.0</span>
</pre></div>
</div>
<p>To customize the Compute cells, use the configuration
option settings documented in the table <a class="reference internal" href="config-options.html#nova-cells"><span>Description of cell configuration options</span></a>.</p>
</div>
<div class="section" id="cell-scheduling-configuration">
<h2>Cell scheduling configuration<a class="headerlink" href="#cell-scheduling-configuration" title="Permalink to this headline">¶</a></h2>
<p>To determine the best cell to use to launch a new instance,
Compute uses a set of filters and weights defined in the
<code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code> file. The following options are
available to prioritize cells for scheduling:</p>
<dl class="docutils">
<dt>scheduler_filter_classes</dt>
<dd>List of filter classes. By default <code class="docutils literal"><span class="pre">nova.cells.filters.all_filters</span></code>
is specified, which maps to all cells filters included with Compute
(see the section called <a class="reference internal" href="schedulers.html#compute-scheduler-filters"><span>Filters</span></a>).</dd>
<dt>scheduler_weight_classes</dt>
<dd><p class="first">List of weight classes.
By default <code class="docutils literal"><span class="pre">nova.cells.weights.all_weighers</span></code> is specified,
which maps to all cell weight algorithms included with Compute.
The following modules are available:</p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">mute_child</span></code>. Downgrades the likelihood of child cells being chosen
for scheduling requests, which haven&#8217;t sent capacity or capability
updates in a while. Options include <code class="docutils literal"><span class="pre">mute_weight_multiplier</span></code>
(multiplier for mute children; value should be negative).</li>
<li><code class="docutils literal"><span class="pre">ram_by_instance_type</span></code>. Select cells with the most RAM capacity
for the instance type being requested. Because higher weights win,
Compute returns the number of available units for the instance type
requested. The <code class="docutils literal"><span class="pre">ram_weight_multiplier</span></code> option defaults to 10.0
that adds to the weight by a factor of 10.
Use a negative number to stack VMs on one host instead of spreading
out new VMs to more hosts in the cell.</li>
<li><code class="docutils literal"><span class="pre">weight_offset</span></code>. Allows modifying the database to weight a
particular cell. You can use this when you want to disable a
cell (for example, &#8216;0&#8217;), or to set a default cell by making its
<code class="docutils literal"><span class="pre">weight_offset</span></code> very high (for example, &#8216;999999999999999&#8217;).
The highest weight will be the first cell to be scheduled for
launching an instance.</li>
</ul>
</dd>
</dl>
<p>Additionally, the following options are available for the cell scheduler:</p>
<dl class="docutils">
<dt>scheduler_retries</dt>
<dd>Specifies how many times the scheduler tries to launch a new
instance when no cells are available (default=10).</dd>
<dt>scheduler_retry_delay</dt>
<dd>Specifies the delay (in seconds) between retries (default=2).</dd>
</dl>
<p>As an admin user, you can also add a filter that directs builds to
a particular cell. The <code class="docutils literal"><span class="pre">policy.json</span></code> file must have a line with
<code class="docutils literal"><span class="pre">&quot;cells_scheduler_filter:TargetCellFilter&quot;</span> <span class="pre">:</span> <span class="pre">&quot;is_admin:True&quot;</span></code>
to let an admin user specify a scheduler hint to direct a build to
a particular cell.</p>
</div>
<div class="section" id="optional-cell-configuration">
<h2>Optional cell configuration<a class="headerlink" href="#optional-cell-configuration" title="Permalink to this headline">¶</a></h2>
<p>Cells store all inter-cell communication data, including user names
and passwords, in the database. Because the cells data is not updated
very frequently, use the <code class="docutils literal"><span class="pre">[cells]cells_config</span></code> option to specify
a JSON file to store cells data. With this configuration,
the database is no longer consulted when reloading the cells data.
The file must have columns present in the Cell model (excluding
common database fields and the <code class="docutils literal"><span class="pre">id</span></code> column). You must specify the
queue connection information through a <code class="docutils literal"><span class="pre">transport_url</span></code> field,
instead of <code class="docutils literal"><span class="pre">username</span></code>, <code class="docutils literal"><span class="pre">password</span></code>, and so on.
The <code class="docutils literal"><span class="pre">transport_url</span></code> has the following form:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">rabbit://USERNAME:PASSWORD@HOSTNAME:PORT/VIRTUAL_HOST</span>
</pre></div>
</div>
<p>The scheme can only be <code class="docutils literal"><span class="pre">rabbit</span></code>.
The following sample shows this optional configuration:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;parent&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
        <span class="nt">&quot;api_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://api.example.com:8774&quot;</span><span class="p">,</span>
        <span class="nt">&quot;transport_url&quot;</span><span class="p">:</span> <span class="s2">&quot;rabbit://rabbit.example.com&quot;</span><span class="p">,</span>
        <span class="nt">&quot;weight_offset&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="nt">&quot;weight_scale&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="nt">&quot;is_parent&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="nt">&quot;cell1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;cell1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;api_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://api.example.com:8774&quot;</span><span class="p">,</span>
        <span class="nt">&quot;transport_url&quot;</span><span class="p">:</span> <span class="s2">&quot;rabbit://rabbit1.example.com&quot;</span><span class="p">,</span>
        <span class="nt">&quot;weight_offset&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="nt">&quot;weight_scale&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="nt">&quot;is_parent&quot;</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="nt">&quot;cell2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;cell2&quot;</span><span class="p">,</span>
        <span class="nt">&quot;api_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://api.example.com:8774&quot;</span><span class="p">,</span>
        <span class="nt">&quot;transport_url&quot;</span><span class="p">:</span> <span class="s2">&quot;rabbit://rabbit2.example.com&quot;</span><span class="p">,</span>
        <span class="nt">&quot;weight_offset&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="nt">&quot;weight_scale&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="nt">&quot;is_parent&quot;</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="schedulers.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Compute schedulers"></i></a>
          
          
            <a href="conductor.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Conductor"></i></a>
          
            <a id="logABugLink3" href="#" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2016-12-31 09:03</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org/" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='http://docs.openstack.org/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index-2.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../config-overview.html">OpenStack configuration overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common-configurations.html">Common configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../application-catalog.html">Application Catalog service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bare-metal.html">Bare Metal service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block-storage.html">Block Storage service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../clustering.html">Clustering service</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../compute.html">Compute service</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config-options.html">The full set of available options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tables/conf-changes/nova.html">New, updated, and deprecated options in Newton for Compute</a></li>
<li class="toctree-l2"><a class="reference internal" href="nova-conf.html">Overview of nova.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">Compute API configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="resize.html">Configure resize</a></li>
<li class="toctree-l2"><a class="reference internal" href="database-connections.html">Database configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="fibre-channel.html">Fibre Channel support in Compute</a></li>
<li class="toctree-l2"><a class="reference internal" href="iscsi-offload.html">iSCSI interface and offload support in Compute</a></li>
<li class="toctree-l2"><a class="reference internal" href="hypervisors.html">Hypervisors</a></li>
<li class="toctree-l2"><a class="reference internal" href="schedulers.html">Compute schedulers</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="conductor.html">Conductor</a></li>
<li class="toctree-l2"><a class="reference internal" href="logs.html">Compute log files</a></li>
<li class="toctree-l2"><a class="reference internal" href="nova-conf-samples.html">Example nova.conf configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="samples/index.html">Compute service sample configuration files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-processing.html">Data Processing service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../database.html">Database service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../identity.html">Identity service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../image.html">Image service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../message.html">Message service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking.html">Networking service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../object-storage.html">Object Storage service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orchestration.html">Orchestration service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shared-file-systems.html">Shared File Systems service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../telemetry.html">Telemetry service</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../policy-json-file.html">The policy.json file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../firewalls-default-ports.html">Firewalls and default ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org/">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org/">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org/">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com/" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-1.11.3.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "compute/cells" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/config-reference/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 8769323640f01e3e92c0a6af672b0e6fab8a4af7";
        var bugProject = "openstack-manuals";
        var bugTitle = "Cells in Configuration Reference";
    var fieldTags = "config-reference";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2016-12-31 09:03";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>

<!-- Mirrored from docs.openstack.org/newton/config-reference/compute/cells.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Jan 2017 09:29:41 GMT -->
</html>