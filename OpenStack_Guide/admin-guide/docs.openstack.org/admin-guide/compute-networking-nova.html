<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  
<!-- Mirrored from docs.openstack.org/admin-guide/compute-networking-nova.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Jan 2017 09:05:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Networking with nova-network</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../../maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="http://docs.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org/">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org/">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://ask.openstack.org/">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/videos/summits">Summit Videos</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
    <h2>Networking with nova-network</h2>
  </div>
  <div class="docs-actions">
    
    <a href="compute-images-instances.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Images and instances"></i></a>
    
    
    <a href="compute-system-admin.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: System administration"></i></a>
    
    <a id="logABugLink1" href="#" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2016-12-30 18:29</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index-2.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Networking with nova-network</a><ul>
<li><a class="reference internal" href="#networking-concepts">Networking concepts</a></li>
<li><a class="reference internal" href="#dhcp-server-dnsmasq">DHCP server: dnsmasq</a></li>
<li><a class="reference internal" href="#configure-compute-to-use-ipv6-addresses">Configure Compute to use IPv6 addresses</a></li>
<li><a class="reference internal" href="#metadata-service">Metadata service</a></li>
<li><a class="reference internal" href="#enable-ping-and-ssh-on-vms">Enable ping and SSH on VMs</a></li>
<li><a class="reference internal" href="#configure-public-floating-ip-addresses">Configure public (floating) IP addresses</a><ul>
<li><a class="reference internal" href="#private-and-public-ip-addresses">Private and public IP addresses</a></li>
<li><a class="reference internal" href="#enable-ip-forwarding">Enable IP forwarding</a></li>
<li><a class="reference internal" href="#create-a-list-of-available-floating-ip-addresses">Create a list of available floating IP addresses</a></li>
<li><a class="reference internal" href="#automatically-add-floating-ips">Automatically add floating IPs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#remove-a-network-from-a-project">Remove a network from a project</a></li>
<li><a class="reference internal" href="#multiple-interfaces-for-instances-multinic">Multiple interfaces for instances (multinic)</a><ul>
<li><a class="reference internal" href="#using-multinic">Using multinic</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting-networking">Troubleshooting Networking</a><ul>
<li><a class="reference internal" href="#cannot-reach-floating-ips">Cannot reach floating IPs</a></li>
<li><a class="reference internal" href="#problem">Problem</a></li>
<li><a class="reference internal" href="#solution">Solution</a></li>
<li><a class="reference internal" href="#temporarily-disable-firewall">Temporarily disable firewall</a></li>
<li><a class="reference internal" href="#id1">Problem</a></li>
<li><a class="reference internal" href="#id2">Solution</a></li>
<li><a class="reference internal" href="#packet-loss-from-instances-to-nova-network-server-vlanmanager-mode">Packet loss from instances to nova-network server (VLANManager mode)</a></li>
<li><a class="reference internal" href="#id3">Problem</a></li>
<li><a class="reference internal" href="#id4">Solution</a></li>
<li><a class="reference internal" href="#kvm-network-connectivity-works-initially-then-fails">KVM: Network connectivity works initially, then fails</a></li>
<li><a class="reference internal" href="#id5">Problem</a></li>
<li><a class="reference internal" href="#id6">Solution</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="networking-with-nova-network">
<h1>Networking with nova-network<a class="headerlink" href="#networking-with-nova-network" title="Permalink to this headline">¶</a></h1>
<p>Understanding the networking configuration options helps you design the
best configuration for your Compute instances.</p>
<p>You can choose to either install and configure <code class="docutils literal"><span class="pre">nova-network</span></code> or use the
OpenStack Networking service (neutron). This section contains a brief
overview of <code class="docutils literal"><span class="pre">nova-network</span></code>. For more information about OpenStack
Networking, see <a class="reference internal" href="networking.html#networking"><span>Networking</span></a>.</p>
<div class="section" id="networking-concepts">
<h2>Networking concepts<a class="headerlink" href="#networking-concepts" title="Permalink to this headline">¶</a></h2>
<p>Compute assigns a private IP address to each VM instance. Compute makes
a distinction between fixed IPs and floating IP. Fixed IPs are IP
addresses that are assigned to an instance on creation and stay the same
until the instance is explicitly terminated. Floating IPs are addresses
that can be dynamically associated with an instance. A floating IP
address can be disassociated and associated with another instance at any
time. A user can reserve a floating IP for their project.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently, Compute with <code class="docutils literal"><span class="pre">nova-network</span></code> only supports Linux bridge
networking that allows virtual interfaces to connect to the outside
network through the physical interface.</p>
</div>
<p>The network controller with <code class="docutils literal"><span class="pre">nova-network</span></code> provides virtual networks to
enable compute servers to interact with each other and with the public
network. Compute with <code class="docutils literal"><span class="pre">nova-network</span></code> supports the following network modes,
which are implemented as Network Manager types:</p>
<dl class="docutils">
<dt>Flat Network Manager</dt>
<dd>In this mode, a network administrator specifies a subnet. IP
addresses for VM instances are assigned from the subnet, and then
injected into the image on launch. Each instance receives a fixed IP
address from the pool of available addresses. A system administrator
must create the Linux networking bridge (typically named <code class="docutils literal"><span class="pre">br100</span></code>,
although this is configurable) on the systems running the
<code class="docutils literal"><span class="pre">nova-network</span></code> service. All instances of the system are attached to
the same bridge, which is configured manually by the network
administrator.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Configuration injection currently only works on Linux-style
systems that keep networking configuration in
<code class="docutils literal"><span class="pre">/etc/network/interfaces</span></code>.</p>
</div>
<dl class="docutils">
<dt>Flat DHCP Network Manager</dt>
<dd><p class="first">In this mode, OpenStack starts a DHCP server (dnsmasq) to allocate
IP addresses to VM instances from the specified subnet, in addition
to manually configuring the networking bridge. IP addresses for VM
instances are assigned from a subnet specified by the network
administrator.</p>
<p>Like flat mode, all instances are attached to a single bridge on the
compute node. Additionally, a DHCP server configures instances
depending on single-/multi-host mode, alongside each <code class="docutils literal"><span class="pre">nova-network</span></code>.
In this mode, Compute does a bit more configuration. It attempts to
bridge into an Ethernet device (<code class="docutils literal"><span class="pre">flat_interface</span></code>, eth0 by
default). For every instance, Compute allocates a fixed IP address
and configures dnsmasq with the MAC ID and IP address for the VM.
Dnsmasq does not take part in the IP address allocation process, it
only hands out IPs according to the mapping done by Compute.
Instances receive their fixed IPs with the <strong class="command">dhcpdiscover</strong> command.
These IPs are not assigned to any of the host&#8217;s network interfaces,
only to the guest-side interface for the VM.</p>
<p class="last">In any setup with flat networking, the hosts providing the
<code class="docutils literal"><span class="pre">nova-network</span></code> service are responsible for forwarding traffic from the
private network. They also run and configure dnsmasq as a DHCP
server listening on this bridge, usually on IP address 10.0.0.1 (see
<a class="reference internal" href="#compute-dnsmasq"><span>DHCP server: dnsmasq</span></a>). Compute can determine
the NAT entries for each network, although sometimes NAT is not
used, such as when the network has been configured with all public
IPs, or if a hardware router is used (which is a high availability
option). In this case, hosts need to have <code class="docutils literal"><span class="pre">br100</span></code> configured and
physically connected to any other nodes that are hosting VMs. You
must set the <code class="docutils literal"><span class="pre">flat_network_bridge</span></code> option or create networks with
the bridge parameter in order to avoid raising an error. Compute
nodes have iptables or ebtables entries created for each project and
instance to protect against MAC ID or IP address spoofing and ARP
poisoning.</p>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In single-host Flat DHCP mode you will be able to ping VMs
through their fixed IP from the <code class="docutils literal"><span class="pre">nova-network</span></code> node, but you
cannot ping them from the compute nodes. This is expected
behavior.</p>
</div>
<dl class="docutils">
<dt>VLAN Network Manager</dt>
<dd><p class="first">This is the default mode for OpenStack Compute. In this mode,
Compute creates a VLAN and bridge for each project. For
multiple-machine installations, the VLAN Network Mode requires a
switch that supports VLAN tagging (IEEE 802.1Q). The project gets a
range of private IPs that are only accessible from inside the VLAN.
In order for a user to access the instances in their project, a
special VPN instance (code named <code class="docutils literal"><span class="pre">cloudpipe</span></code>) needs to be created.
Compute generates a certificate and key for the user to access the
VPN and starts the VPN automatically. It provides a private network
segment for each project&#8217;s instances that can be accessed through a
dedicated VPN connection from the internet. In this mode, each
project gets its own VLAN, Linux networking bridge, and subnet.</p>
<p class="last">The subnets are specified by the network administrator, and are
assigned dynamically to a project when required. A DHCP server is
started for each VLAN to pass out IP addresses to VM instances from
the subnet assigned to the project. All instances belonging to one
project are bridged into the same VLAN for that project. OpenStack
Compute creates the Linux networking bridges and VLANs when
required.</p>
</dd>
</dl>
<p>These network managers can co-exist in a cloud system. However, because
you cannot select the type of network for a given project, you cannot
configure multiple network types in a single Compute installation.</p>
<p>All network managers configure the network using network drivers. For
example, the Linux L3 driver (<code class="docutils literal"><span class="pre">l3.py</span></code> and <code class="docutils literal"><span class="pre">linux_net.py</span></code>), which
makes use of <code class="docutils literal"><span class="pre">iptables</span></code>, <code class="docutils literal"><span class="pre">route</span></code> and other network management
facilities, and the libvirt <a class="reference external" href="http://libvirt.org/formatnwfilter.html">network filtering
facilities</a>. The driver is
not tied to any particular network manager; all network managers use the
same driver. The driver usually initializes only when the first VM lands
on this host node.</p>
<p>All network managers operate in either single-host or multi-host mode.
This choice greatly influences the network configuration. In single-host
mode, a single <code class="docutils literal"><span class="pre">nova-network</span></code> service provides a default gateway for VMs
and hosts a single DHCP server (dnsmasq). In multi-host mode, each
compute node runs its own <code class="docutils literal"><span class="pre">nova-network</span></code> service. In both cases, all
traffic between VMs and the internet flows through <code class="docutils literal"><span class="pre">nova-network</span></code>. Each
mode has benefits and drawbacks. For more on this, see the Network
Topology section in the <a class="reference external" href="http://docs.openstack.org/ops-guide/arch-network-design.html#network-topology">OpenStack Operations Guide</a>.</p>
<p>All networking options require network connectivity to be already set up
between OpenStack physical nodes. OpenStack does not configure any
physical network interfaces. All network managers automatically create
VM virtual interfaces. Some network managers can also create network
bridges such as <code class="docutils literal"><span class="pre">br100</span></code>.</p>
<p>The internal network interface is used for communication with VMs. The
interface should not have an IP address attached to it before OpenStack
installation, it serves only as a fabric where the actual endpoints are
VMs and dnsmasq. Additionally, the internal network interface must be in
<code class="docutils literal"><span class="pre">promiscuous</span></code> mode, so that it can receive packets whose target MAC
address is the guest VM, not the host.</p>
<p>All machines must have a public and internal network interface
(controlled by these options: <code class="docutils literal"><span class="pre">public_interface</span></code> for the public
interface, and <code class="docutils literal"><span class="pre">flat_interface</span></code> and <code class="docutils literal"><span class="pre">vlan_interface</span></code> for the
internal interface with flat or VLAN managers). This guide refers to the
public network as the external network and the private network as the
internal or project network.</p>
<p>For flat and flat DHCP modes, use the <strong class="command">nova network-create</strong> command
to create a network:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova network-create vmnet <span class="se">\</span>
<span class="go">  --fixed-range-v4 10.0.0.0/16 --fixed-cidr 10.0.20.0/24 --bridge br100</span>
</pre></div>
</div>
<dl class="docutils">
<dt>This example uses the following parameters:</dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--fixed-range-v4</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>specifies the network subnet.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--fixed-cidr</span></kbd></td>
<td>specifies a range of fixed IP addresses to allocate,
and can be a subset of the <code class="docutils literal"><span class="pre">--fixed-range-v4</span></code>
argument.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--bridge</span></kbd></td>
<td>specifies the bridge device to which this network is
connected on every compute node.</td></tr>
</tbody>
</table>
</dd>
</dl>
</div>
<div class="section" id="dhcp-server-dnsmasq">
<span id="compute-dnsmasq"></span><h2>DHCP server: dnsmasq<a class="headerlink" href="#dhcp-server-dnsmasq" title="Permalink to this headline">¶</a></h2>
<p>The Compute service uses
<a class="reference external" href="http://www.thekelleys.org.uk/dnsmasq/doc.html">dnsmasq</a> as the DHCP
server when using either Flat DHCP Network Manager or VLAN Network
Manager. For Compute to operate in IPv4/IPv6 dual-stack mode, use at
least dnsmasq v2.63. The <code class="docutils literal"><span class="pre">nova-network</span></code> service is responsible for
starting dnsmasq processes.</p>
<p>The behavior of dnsmasq can be customized by creating a dnsmasq
configuration file. Specify the configuration file using the
<code class="docutils literal"><span class="pre">dnsmasq_config_file</span></code> configuration option:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">dnsmasq_config_file</span><span class="o">=</span><span class="s">/etc/dnsmasq-nova.conf</span>
</pre></div>
</div>
<p>For more information about creating a dnsmasq configuration file, see
the <a class="reference external" href="http://docs.openstack.org/newton/config-reference/">OpenStack Configuration
Reference</a>,
and <a class="reference external" href="http://www.thekelleys.org.uk/dnsmasq/docs/dnsmasq.conf.example">the dnsmasq
documentation</a>.</p>
<p>Dnsmasq also acts as a caching DNS server for instances. You can specify
the DNS server that dnsmasq uses by setting the <code class="docutils literal"><span class="pre">dns_server</span></code>
configuration option in <code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code>. This example configures
dnsmasq to use Google&#8217;s public DNS server:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">dns_server</span><span class="o">=</span><span class="s">8.8.8.8</span>
</pre></div>
</div>
<p>Dnsmasq logs to syslog (typically <code class="docutils literal"><span class="pre">/var/log/syslog</span></code> or
<code class="docutils literal"><span class="pre">/var/log/messages</span></code>, depending on Linux distribution). Logs can be
useful for troubleshooting, especially in a situation where VM instances
boot successfully but are not reachable over the network.</p>
<p>Administrators can specify the starting point IP address to reserve with
the DHCP server (in the format n.n.n.n) with this command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova-manage fixed reserve --address IP_ADDRESS
</pre></div>
</div>
<p>This reservation only affects which IP address the VMs start at, not the
fixed IP addresses that <code class="docutils literal"><span class="pre">nova-network</span></code> places on the bridges.</p>
</div>
<div class="section" id="configure-compute-to-use-ipv6-addresses">
<h2>Configure Compute to use IPv6 addresses<a class="headerlink" href="#configure-compute-to-use-ipv6-addresses" title="Permalink to this headline">¶</a></h2>
<p>If you are using OpenStack Compute with <code class="docutils literal"><span class="pre">nova-network</span></code>, you can put
Compute into dual-stack mode, so that it uses both IPv4 and IPv6
addresses for communication. In dual-stack mode, instances can acquire
their IPv6 global unicast addresses by using a stateless address
auto-configuration mechanism [RFC 4862/2462]. IPv4/IPv6 dual-stack mode
works with both <code class="docutils literal"><span class="pre">VlanManager</span></code> and <code class="docutils literal"><span class="pre">FlatDHCPManager</span></code> networking
modes.</p>
<p>In <code class="docutils literal"><span class="pre">VlanManager</span></code> networking mode, each project uses a different 64-bit
global routing prefix. In <code class="docutils literal"><span class="pre">FlatDHCPManager</span></code> mode, all instances use
one 64-bit global routing prefix.</p>
<p>This configuration was tested with virtual machine images that have an
IPv6 stateless address auto-configuration capability. This capability is
required for any VM to run with an IPv6 address. You must use an EUI-64
address for stateless address auto-configuration. Each node that
executes a <code class="docutils literal"><span class="pre">nova-*</span></code> service must have <code class="docutils literal"><span class="pre">python-netaddr</span></code> and <code class="docutils literal"><span class="pre">radvd</span></code>
installed.</p>
<p><strong>Switch into IPv4/IPv6 dual-stack mode</strong></p>
<ol class="arabic">
<li><p class="first">For every node running a <code class="docutils literal"><span class="pre">nova-*</span></code> service, install python-netaddr:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> apt-get install python-netaddr
</pre></div>
</div>
</li>
<li><p class="first">For every node running <code class="docutils literal"><span class="pre">nova-network</span></code>, install <code class="docutils literal"><span class="pre">radvd</span></code> and configure
IPv6 networking:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> apt-get install radvd
<span class="gp">#</span> <span class="nb">echo</span> <span class="m">1</span> &gt; /proc/sys/net/ipv6/conf/all/forwarding
<span class="gp">#</span> <span class="nb">echo</span> <span class="m">0</span> &gt; /proc/sys/net/ipv6/conf/all/accept_ra
</pre></div>
</div>
</li>
<li><p class="first">On all nodes, edit the <code class="docutils literal"><span class="pre">nova.conf</span></code> file and specify
<code class="docutils literal"><span class="pre">use_ipv6</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
</li>
<li><p class="first">Restart all <code class="docutils literal"><span class="pre">nova-*</span></code> services.</p>
</li>
</ol>
<p><strong>IPv6 configuration options</strong></p>
<p>You can use the following options with the <strong class="command">nova network-create</strong>
command:</p>
<ul>
<li><p class="first">Add a fixed range for IPv6 addresses to the <strong class="command">nova network-create</strong>
command. Specify <code class="docutils literal"><span class="pre">public</span></code> or <code class="docutils literal"><span class="pre">private</span></code> after the <code class="docutils literal"><span class="pre">network-create</span></code>
parameter.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova network-create public --fixed-range-v4 FIXED_RANGE_V4 <span class="se">\</span>
<span class="go">  --vlan VLAN_ID --vpn VPN_START --fixed-range-v6 FIXED_RANGE_V6</span>
</pre></div>
</div>
</li>
<li><p class="first">Set the IPv6 global routing prefix by using the
<code class="docutils literal"><span class="pre">--fixed_range_v6</span></code> parameter. The default value for the parameter
is <code class="docutils literal"><span class="pre">fd00::/48</span></code>.</p>
<p>When you use <code class="docutils literal"><span class="pre">FlatDHCPManager</span></code>, the command uses the original
<code class="docutils literal"><span class="pre">--fixed_range_v6</span></code> value. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova network-create public  --fixed-range-v4 10.0.2.0/24 <span class="se">\</span>
<span class="go">  --fixed-range-v6 fd00:1::/48</span>
</pre></div>
</div>
</li>
<li><p class="first">When you use <code class="docutils literal"><span class="pre">VlanManager</span></code>, the command increments the subnet ID
to create subnet prefixes. Guest VMs use this prefix to generate
their IPv6 global unicast addresses. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova network-create public --fixed-range-v4 10.0.1.0/24 --vlan <span class="m">100</span> <span class="se">\</span>
<span class="go">  --vpn 1000 --fixed-range-v6 fd00:1::/48</span>
</pre></div>
</div>
</li>
</ul>
<table border="1" class="docutils" id="id7">
<caption><span class="caption-text">Description of IPv6 configuration options</span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Configuration option = Default value</th>
<th class="head">Description</th>
</tr>
<tr class="row-even"><th class="head">[DEFAULT]</th>
<th class="head">&nbsp;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>fixed_range_v6 = fd00::/48</td>
<td>(StrOpt) Fixed IPv6 address block</td>
</tr>
<tr class="row-even"><td>gateway_v6 = None</td>
<td>(StrOpt) Default IPv6 gateway</td>
</tr>
<tr class="row-odd"><td>ipv6_backend = rfc2462</td>
<td>(StrOpt) Backend to use for IPv6 generation</td>
</tr>
<tr class="row-even"><td>use_ipv6 = False</td>
<td>(BoolOpt) Use IPv6</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="metadata-service">
<h2>Metadata service<a class="headerlink" href="#metadata-service" title="Permalink to this headline">¶</a></h2>
<p>Compute uses a metadata service for virtual machine instances to
retrieve instance-specific data. Instances access the metadata service
at <code class="docutils literal"><span class="pre">http://169.254.169.254</span></code>. The metadata service supports two sets of
APIs: an OpenStack metadata API and an EC2-compatible API. Both APIs are
versioned by date.</p>
<p>To retrieve a list of supported versions for the OpenStack metadata API,
make a GET request to <code class="docutils literal"><span class="pre">http://169.254.169.254/openstack</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl http://169.254.169.254/openstack
<span class="go">2012-08-10</span>
<span class="go">2013-04-04</span>
<span class="go">2013-10-17</span>
<span class="go">latest</span>
</pre></div>
</div>
<p>To list supported versions for the EC2-compatible metadata API, make a
GET request to <code class="docutils literal"><span class="pre">http://169.254.169.254</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl http://169.254.169.254
<span class="go">1.0</span>
<span class="go">2007-01-19</span>
<span class="go">2007-03-01</span>
<span class="go">2007-08-29</span>
<span class="go">2007-10-10</span>
<span class="go">2007-12-15</span>
<span class="go">2008-02-01</span>
<span class="go">2008-09-01</span>
<span class="go">2009-04-04</span>
<span class="go">latest</span>
</pre></div>
</div>
<p>If you write a consumer for one of these APIs, always attempt to access
the most recent API version supported by your consumer first, then fall
back to an earlier version if the most recent one is not available.</p>
<p>Metadata from the OpenStack API is distributed in JSON format. To
retrieve the metadata, make a GET request to
<code class="docutils literal"><span class="pre">http://169.254.169.254/openstack/2012-08-10/meta_data.json</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl http://169.254.169.254/openstack/2012-08-10/meta_data.json
</pre></div>
</div>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="nt">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;d8e02d56-2648-49a3-bf97-6be8f1204f38&quot;</span><span class="p">,</span>
   <span class="nt">&quot;availability_zone&quot;</span><span class="p">:</span> <span class="s2">&quot;nova&quot;</span><span class="p">,</span>
   <span class="nt">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;test.novalocal&quot;</span><span class="p">,</span>
   <span class="nt">&quot;launch_index&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
   <span class="nt">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;priority&quot;</span><span class="p">:</span> <span class="s2">&quot;low&quot;</span><span class="p">,</span>
      <span class="nt">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;webserver&quot;</span>
   <span class="p">},</span>
   <span class="nt">&quot;project_id&quot;</span><span class="p">:</span> <span class="s2">&quot;f7ac731cc11f40efbc03a9f9e1d1d21f&quot;</span><span class="p">,</span>
   <span class="nt">&quot;public_keys&quot;</span><span class="p">:</span> <span class="p">{</span>
       <span class="nt">&quot;mykey&quot;</span><span class="p">:</span> <span class="s2">&quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDYVEprvtYJXVOBN0XNKV\</span>
<span class="s2">                 VRNCRX6BlnNbI+USLGais1sUWPwtSg7z9K9vhbYAPUZcq8c/s5S9dg5vTH\</span>
<span class="s2">                 bsiyPCIDOKyeHba4MUJq8Oh5b2i71/3BISpyxTBH/uZDHdslW2a+SrPDCe\</span>
<span class="s2">                 uMMoss9NFhBdKtDkdG9zyi0ibmCP6yMdEX8Q== Generated by Nova\n&quot;</span>
   <span class="p">},</span>
   <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Instances also retrieve user data (passed as the <code class="docutils literal"><span class="pre">user_data</span></code> parameter
in the API call or by the <code class="xref std std-option docutils literal"><span class="pre">--user_data</span></code> flag in the
<strong class="command">openstack server create</strong> command) through the metadata service, by making a
GET request to <code class="docutils literal"><span class="pre">http://169.254.169.254/openstack/2012-08-10/user_data</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl http://169.254.169.254/openstack/2012-08-10/user_data
<span class="gp">#</span>!/bin/bash
<span class="go">echo &#39;Extra user data here&#39;</span>
</pre></div>
</div>
<p>The metadata service has an API that is compatible with version
2009-04-04 of the <a class="reference external" href="http://docs.amazonwebservices.com/AWSEC2/2009-04-04/UserGuide/AESDG-chapter-instancedata.html">Amazon EC2 metadata
service</a>.
This means that virtual machine images designed for EC2 will work
properly with OpenStack.</p>
<p>The EC2 API exposes a separate URL for each metadata element. Retrieve a
listing of these elements by making a GET query to
<code class="docutils literal"><span class="pre">http://169.254.169.254/2009-04-04/meta-data/</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl http://169.254.169.254/2009-04-04/meta-data/
<span class="go">ami-id</span>
<span class="go">ami-launch-index</span>
<span class="go">ami-manifest-path</span>
<span class="go">block-device-mapping/</span>
<span class="go">hostname</span>
<span class="go">instance-action</span>
<span class="go">instance-id</span>
<span class="go">instance-type</span>
<span class="go">kernel-id</span>
<span class="go">local-hostname</span>
<span class="go">local-ipv4</span>
<span class="go">placement/</span>
<span class="go">public-hostname</span>
<span class="go">public-ipv4</span>
<span class="go">public-keys/</span>
<span class="go">ramdisk-id</span>
<span class="go">reservation-id</span>
<span class="go">security-groups</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl http://169.254.169.254/2009-04-04/meta-data/block-device-mapping/
<span class="go">ami</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl http://169.254.169.254/2009-04-04/meta-data/placement/
<span class="go">availability-zone</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl http://169.254.169.254/2009-04-04/meta-data/public-keys/
<span class="go">0=mykey</span>
</pre></div>
</div>
<p>Instances can retrieve the public SSH key (identified by keypair name
when a user requests a new instance) by making a GET request to
<code class="docutils literal"><span class="pre">http://169.254.169.254/2009-04-04/meta-data/public-keys/0/openssh-key</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl http://169.254.169.254/2009-04-04/meta-data/public-keys/0/openssh-key
<span class="go">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDYVEprvtYJXVOBN0XNKVVRNCRX6BlnNbI+US\</span>
<span class="go">LGais1sUWPwtSg7z9K9vhbYAPUZcq8c/s5S9dg5vTHbsiyPCIDOKyeHba4MUJq8Oh5b2i71/3B\</span>
<span class="go">ISpyxTBH/uZDHdslW2a+SrPDCeuMMoss9NFhBdKtDkdG9zyi0ibmCP6yMdEX8Q== Generated\</span>
<span class="go">by Nova</span>
</pre></div>
</div>
<p>Instances can retrieve user data by making a GET request to
<code class="docutils literal"><span class="pre">http://169.254.169.254/2009-04-04/user-data</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl http://169.254.169.254/2009-04-04/user-data
<span class="gp">#</span>!/bin/bash
<span class="go">echo &#39;Extra user data here&#39;</span>
</pre></div>
</div>
<p>The metadata service is implemented by either the <code class="docutils literal"><span class="pre">nova-api</span></code> service or
the <code class="docutils literal"><span class="pre">nova-api-metadata</span></code> service. Note that the <code class="docutils literal"><span class="pre">nova-api-metadata</span></code> service
is generally only used when running in multi-host mode, as it retrieves
instance-specific metadata. If you are running the <code class="docutils literal"><span class="pre">nova-api</span></code> service, you
must have <code class="docutils literal"><span class="pre">metadata</span></code> as one of the elements listed in the
<code class="docutils literal"><span class="pre">enabled_apis</span></code> configuration option in <code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code>. The
default <code class="docutils literal"><span class="pre">enabled_apis</span></code> configuration setting includes the metadata
service, so you do not need to modify it.</p>
<p>Hosts access the service at <code class="docutils literal"><span class="pre">169.254.169.254:80</span></code>, and this is
translated to <code class="docutils literal"><span class="pre">metadata_host:metadata_port</span></code> by an iptables rule
established by the <code class="docutils literal"><span class="pre">nova-network</span></code> service. In multi-host mode, you can set
<code class="docutils literal"><span class="pre">metadata_host</span></code> to <code class="docutils literal"><span class="pre">127.0.0.1</span></code>.</p>
<p>For instances to reach the metadata service, the <code class="docutils literal"><span class="pre">nova-network</span></code> service
must configure iptables to NAT port <code class="docutils literal"><span class="pre">80</span></code> of the <code class="docutils literal"><span class="pre">169.254.169.254</span></code>
address to the IP address specified in <code class="docutils literal"><span class="pre">metadata_host</span></code> (this defaults
to <code class="docutils literal"><span class="pre">$my_ip</span></code>, which is the IP address of the <code class="docutils literal"><span class="pre">nova-network</span></code> service) and
port specified in <code class="docutils literal"><span class="pre">metadata_port</span></code> (which defaults to <code class="docutils literal"><span class="pre">8775</span></code>) in
<code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">metadata_host</span></code> configuration option must be an IP address,
not a host name.</p>
</div>
<p>The default Compute service settings assume that <code class="docutils literal"><span class="pre">nova-network</span></code> and
<code class="docutils literal"><span class="pre">nova-api</span></code> are running on the same host. If this is not the case, in the
<code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code> file on the host running <code class="docutils literal"><span class="pre">nova-network</span></code>, set the
<code class="docutils literal"><span class="pre">metadata_host</span></code> configuration option to the IP address of the host
where <code class="docutils literal"><span class="pre">nova-api</span></code> is running.</p>
<table border="1" class="docutils" id="id8">
<caption><span class="caption-text">Description of metadata configuration options</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Configuration option = Default value</th>
<th class="head">Description</th>
</tr>
<tr class="row-even"><th class="head">[DEFAULT]</th>
<th class="head">&nbsp;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>metadata_cache_expiration = 15</td>
<td>(IntOpt) Time in seconds to cache metadata; 0 to disable metadata
caching entirely (not recommended). Increasing this should improve
response times of the metadata API when under heavy load. Higher values
may increase memory usage and result in longer times for host metadata
changes to take effect.</td>
</tr>
<tr class="row-even"><td>metadata_host = $my_ip</td>
<td>(StrOpt) The IP address for the metadata API server</td>
</tr>
<tr class="row-odd"><td>metadata_listen = 0.0.0.0</td>
<td>(StrOpt) The IP address on which the metadata API will listen.</td>
</tr>
<tr class="row-even"><td>metadata_listen_port = 8775</td>
<td>(IntOpt) The port on which the metadata API will listen.</td>
</tr>
<tr class="row-odd"><td>metadata_manager = nova.api.manager.MetadataManager</td>
<td>(StrOpt) OpenStack metadata service manager</td>
</tr>
<tr class="row-even"><td>metadata_port = 8775</td>
<td>(IntOpt) The port for the metadata API port</td>
</tr>
<tr class="row-odd"><td>metadata_workers = None</td>
<td>(IntOpt) Number of workers for metadata service. The default will be the number of CPUs available.</td>
</tr>
<tr class="row-even"><td>vendordata_driver = nova.api.metadata.vendordata_json.JsonFileVendorData</td>
<td>(StrOpt) Driver to use for vendor data</td>
</tr>
<tr class="row-odd"><td>vendordata_jsonfile_path = None</td>
<td>(StrOpt) File to load JSON formatted vendor data from</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="enable-ping-and-ssh-on-vms">
<h2>Enable ping and SSH on VMs<a class="headerlink" href="#enable-ping-and-ssh-on-vms" title="Permalink to this headline">¶</a></h2>
<p>You need to enable <code class="docutils literal"><span class="pre">ping</span></code> and <code class="docutils literal"><span class="pre">ssh</span></code> on your VMs for network access.
This can be done with either the <strong class="command">nova</strong> or <strong class="command">euca2ools</strong>
commands.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Run these commands as root only if the credentials used to interact
with <code class="docutils literal"><span class="pre">nova-api</span></code> are in <code class="docutils literal"><span class="pre">/root/.bashrc</span></code>. If the EC2 credentials in
the <code class="docutils literal"><span class="pre">.bashrc</span></code> file are for an unprivileged user, you must run
these commands as that user instead.</p>
</div>
<p>Enable ping and SSH with <strong class="command">openstack security group rule create</strong>
commands:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack security group rule create default --protocol icmp --dst-port -1:-1 --remote-ip 0.0.0.0/0
<span class="gp">$</span> openstack security group rule create default --protocol tcp --dst-port 22:22 --remote-ip 0.0.0.0/0
</pre></div>
</div>
<p>Enable ping and SSH with <code class="docutils literal"><span class="pre">euca2ools</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> euca-authorize -P icmp -t -1:-1 -s 0.0.0.0/0 default
<span class="gp">$</span> euca-authorize -P tcp -p <span class="m">22</span> -s 0.0.0.0/0 default
</pre></div>
</div>
<p>If you have run these commands and still cannot ping or SSH your
instances, check the number of running <code class="docutils literal"><span class="pre">dnsmasq</span></code> processes, there
should be two. If not, kill the processes and restart the service with
these commands:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> killall dnsmasq
<span class="gp">#</span> service nova-network restart
</pre></div>
</div>
</div>
<div class="section" id="configure-public-floating-ip-addresses">
<h2>Configure public (floating) IP addresses<a class="headerlink" href="#configure-public-floating-ip-addresses" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to configure floating IP addresses with
<code class="docutils literal"><span class="pre">nova-network</span></code>. For information about doing this with OpenStack
Networking, see <a class="reference internal" href="networking-adv-features.html#l3-routing-and-nat"><span>L3 routing and NAT</span></a>.</p>
<div class="section" id="private-and-public-ip-addresses">
<h3>Private and public IP addresses<a class="headerlink" href="#private-and-public-ip-addresses" title="Permalink to this headline">¶</a></h3>
<p>In this section, the term floating IP address is used to refer to an IP
address, usually public, that you can dynamically add to a running
virtual instance.</p>
<p>Every virtual instance is automatically assigned a private IP address.
You can choose to assign a public (or floating) IP address instead.
OpenStack Compute uses network address translation (NAT) to assign
floating IPs to virtual instances.</p>
<p>To be able to assign a floating IP address, edit the
<code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code> file to specify which interface the
<code class="docutils literal"><span class="pre">nova-network</span></code> service should bind public IP addresses to:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">public_interface</span><span class="o">=</span><span class="s">VLAN100</span>
</pre></div>
</div>
<p>If you make changes to the <code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code> file while the
<code class="docutils literal"><span class="pre">nova-network</span></code> service is running, you will need to restart the service to
pick up the changes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Floating IPs are implemented by using a source NAT (SNAT rule in
iptables), so security groups can sometimes display inconsistent
behavior if VMs use their floating IP to communicate with other VMs,
particularly on the same physical host. Traffic from VM to VM across
the fixed network does not have this issue, and so this is the
recommended setup. To ensure that traffic does not get SNATed to the
floating range, explicitly set:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">dmz_cidr</span><span class="o">=</span><span class="s">x.x.x.x/y</span>
</pre></div>
</div>
<p class="last">The <code class="docutils literal"><span class="pre">x.x.x.x/y</span></code> value specifies the range of floating IPs for each
pool of floating IPs that you define. This configuration is also
required if the VMs in the source group have floating IPs.</p>
</div>
</div>
<div class="section" id="enable-ip-forwarding">
<h3>Enable IP forwarding<a class="headerlink" href="#enable-ip-forwarding" title="Permalink to this headline">¶</a></h3>
<p>IP forwarding is disabled by default on most Linux distributions. You
will need to enable it in order to use floating IPs.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">IP forwarding only needs to be enabled on the nodes that run
<code class="docutils literal"><span class="pre">nova-network</span></code>. However, you will need to enable it on all compute
nodes if you use <code class="docutils literal"><span class="pre">multi_host</span></code> mode.</p>
</div>
<p>To check if IP forwarding is enabled, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> cat /proc/sys/net/ipv4/ip_forward
<span class="go">0</span>
</pre></div>
</div>
<p>Alternatively, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> sysctl net.ipv4.ip_forward
<span class="go">net.ipv4.ip_forward = 0</span>
</pre></div>
</div>
<p>In these examples, IP forwarding is disabled.</p>
<p>To enable IP forwarding dynamically, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> sysctl -w net.ipv4.ip_forward<span class="o">=</span>1
</pre></div>
</div>
<p>Alternatively, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> <span class="nb">echo</span> <span class="m">1</span> &gt; /proc/sys/net/ipv4/ip_forward
</pre></div>
</div>
<p>To make the changes permanent, edit the <code class="docutils literal"><span class="pre">/etc/sysctl.conf</span></code> file and
update the IP forwarding setting:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">net.ipv4.ip_forward</span> <span class="o">=</span> <span class="s">1</span>
</pre></div>
</div>
<p>Save the file and run this command to apply the changes:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> sysctl -p
</pre></div>
</div>
<p>You can also apply the changes by restarting the network service:</p>
<ul>
<li><p class="first">on Ubuntu, Debian:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> /etc/init.d/networking restart
</pre></div>
</div>
</li>
<li><p class="first">on RHEL, Fedora, CentOS, openSUSE and SLES:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> service network restart
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="create-a-list-of-available-floating-ip-addresses">
<h3>Create a list of available floating IP addresses<a class="headerlink" href="#create-a-list-of-available-floating-ip-addresses" title="Permalink to this headline">¶</a></h3>
<p>Compute maintains a list of floating IP addresses that are available for
assigning to instances. Use the <strong class="command">nova-manage floating</strong> commands
to perform floating IP operations:</p>
<ul>
<li><p class="first">Add entries to the list:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> nova-manage floating create --pool nova --ip_range 68.99.26.170/31
</pre></div>
</div>
</li>
<li><p class="first">List the floating IP addresses in the pool:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> openstack floating ip list
</pre></div>
</div>
</li>
<li><p class="first">Create specific floating IPs for either a single address or a
subnet:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> nova-manage floating create --pool POOL_NAME --ip_range CIDR
</pre></div>
</div>
</li>
<li><p class="first">Remove floating IP addresses using the same parameters as the create
command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> openstack floating ip delete CIDR
</pre></div>
</div>
</li>
</ul>
<p>For more information about how administrators can associate floating IPs
with instances, see <a class="reference external" href="cli-admin-manage-ip-addresses.html">Manage IP
addresses</a>
in the OpenStack Administrator Guide.</p>
</div>
<div class="section" id="automatically-add-floating-ips">
<h3>Automatically add floating IPs<a class="headerlink" href="#automatically-add-floating-ips" title="Permalink to this headline">¶</a></h3>
<p>You can configure <code class="docutils literal"><span class="pre">nova-network</span></code> to automatically allocate and assign a
floating IP address to virtual instances when they are launched. Add
this line to the <code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code> file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">auto_assign_floating_ip</span><span class="o">=</span><span class="s">True</span>
</pre></div>
</div>
<p>Save the file, and restart <code class="docutils literal"><span class="pre">nova-network</span></code></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If this option is enabled, but all floating IP addresses have
already been allocated, the <strong class="command">openstack server create</strong>
command will fail.</p>
</div>
</div>
</div>
<div class="section" id="remove-a-network-from-a-project">
<h2>Remove a network from a project<a class="headerlink" href="#remove-a-network-from-a-project" title="Permalink to this headline">¶</a></h2>
<p>You cannot delete a network that has been associated to a project. This
section describes the procedure for dissociating it so that it can be
deleted.</p>
<p>In order to disassociate the network, you will need the ID of the
project it has been associated to. To get the project ID, you will need
to be an administrator.</p>
<p>Disassociate the network from the project using the
<strong class="command">nova-manage project scrub</strong> command,
with the project ID as the final parameter:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> nova-manage project scrub --project ID
</pre></div>
</div>
</div>
<div class="section" id="multiple-interfaces-for-instances-multinic">
<h2>Multiple interfaces for instances (multinic)<a class="headerlink" href="#multiple-interfaces-for-instances-multinic" title="Permalink to this headline">¶</a></h2>
<p>The multinic feature allows you to use more than one interface with your
instances. This is useful in several scenarios:</p>
<ul class="simple">
<li>SSL Configurations (VIPs)</li>
<li>Services failover/HA</li>
<li>Bandwidth Allocation</li>
<li>Administrative/Public access to your instances</li>
</ul>
<p>Each VIP represents a separate network with its own IP block. Every
network mode has its own set of changes regarding multinic usage:</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/SCH_5007_V00_NUAC-multi_nic_OpenStack-Flat-manager.jpg"><img alt="_images/SCH_5007_V00_NUAC-multi_nic_OpenStack-Flat-manager.jpg" src="_images/SCH_5007_V00_NUAC-multi_nic_OpenStack-Flat-manager.jpg" style="width: 600px;" /></a>
</div>
<div class="figure">
<a class="reference internal image-reference" href="_images/SCH_5007_V00_NUAC-multi_nic_OpenStack-Flat-DHCP-manager.jpg"><img alt="_images/SCH_5007_V00_NUAC-multi_nic_OpenStack-Flat-DHCP-manager.jpg" src="_images/SCH_5007_V00_NUAC-multi_nic_OpenStack-Flat-DHCP-manager.jpg" style="width: 600px;" /></a>
</div>
<div class="figure">
<a class="reference internal image-reference" href="_images/SCH_5007_V00_NUAC-multi_nic_OpenStack-VLAN-manager.jpg"><img alt="_images/SCH_5007_V00_NUAC-multi_nic_OpenStack-VLAN-manager.jpg" src="_images/SCH_5007_V00_NUAC-multi_nic_OpenStack-VLAN-manager.jpg" style="width: 600px;" /></a>
</div>
<div class="section" id="using-multinic">
<h3>Using multinic<a class="headerlink" href="#using-multinic" title="Permalink to this headline">¶</a></h3>
<p>In order to use multinic, create two networks, and attach them to the
project (named <code class="docutils literal"><span class="pre">project</span></code> on the command line):</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova network-create first-net --fixed-range-v4 20.20.0.0/24 --project-id <span class="nv">$your</span>-project
<span class="gp">$</span> nova network-create second-net --fixed-range-v4 20.20.10.0/24 --project-id <span class="nv">$your</span>-project
</pre></div>
</div>
<p>Each new instance will now receive two IP addresses from their
respective DHCP servers:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server list
<span class="go">+---------+----------+--------+-----------------------------------------+------------+</span>
<span class="go">|ID       | Name     | Status | Networks                                | Image Name |</span>
<span class="go">+---------+----------+--------+-----------------------------------------+------------+</span>
<span class="go">| 1234... | MyServer | ACTIVE | network2=20.20.0.3; private=20.20.10.14 | cirros     |</span>
<span class="go">+---------+----------+--------+-----------------------------------------+------------+</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure you start the second interface on the instance, or it
won&#8217;t be reachable through the second IP.</p>
</div>
<p>This example demonstrates how to set up the interfaces within the
instance. This is the configuration that needs to be applied inside the
image.</p>
<p>Edit the <code class="docutils literal"><span class="pre">/etc/network/interfaces</span></code> file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># The loopback network interface</span>
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp

auto eth1
iface eth1 inet dhcp
</pre></div>
</div>
<p>If the Virtual Network Service Neutron is installed, you can specify the
networks to attach to the interfaces by using the <code class="xref std std-option docutils literal"><span class="pre">--nic</span></code> flag with
the <strong class="command">openstack server create</strong> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server create --image ed8b2a37-5535-4a5f-a615-443513036d71 <span class="se">\</span>
<span class="go">  --flavor 1 --nic net-id=NETWORK1_ID --nic net-id=NETWORK2_ID test-vm1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="troubleshooting-networking">
<h2>Troubleshooting Networking<a class="headerlink" href="#troubleshooting-networking" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cannot-reach-floating-ips">
<h3>Cannot reach floating IPs<a class="headerlink" href="#cannot-reach-floating-ips" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="problem">
<h3>Problem<a class="headerlink" href="#problem" title="Permalink to this headline">¶</a></h3>
<p>You cannot reach your instances through the floating IP address.</p>
</div>
<div class="section" id="solution">
<h3>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Check that the default security group allows ICMP (ping) and SSH
(port 22), so that you can reach the instances:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack security group rule list default
<span class="go">+--------------------------------------+-------------+-----------+-----------------+-----------------------+</span>
<span class="go">| ID                                   | IP Protocol | IP Range  | Port Range      | Remote Security Group |</span>
<span class="go">+--------------------------------------+-------------+-----------+-----------------+-----------------------+</span>
<span class="go">| 63536865-e5b6-4df1-bac5-ca6d97d8f54d | tcp         | 0.0.0.0/0 | 22:22           | None                  |</span>
<span class="go">| e9d3200f-647a-4293-a9fc-e65ceee189ae | icmp        | 0.0.0.0/0 | type=1:code=-1  | None                  |</span>
<span class="go">+--------------------------------------+-------------+-----------+-----------------+-----------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Check the NAT rules have been added to iptables on the node that is
running <code class="docutils literal"><span class="pre">nova-network</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> iptables -L -nv -t nat
<span class="go">-A nova-network-PREROUTING -d 68.99.26.170/32 -j DNAT --to-destination 10.0.0.3</span>
<span class="go">-A nova-network-floating-snat -s 10.0.0.3/32 -j SNAT --to-source 68.99.26.170</span>
</pre></div>
</div>
</li>
<li><p class="first">Check that the public address (<code class="docutils literal"><span class="pre">68.99.26.170</span></code> in
this example), has been added to your public interface. You should
see the address in the listing when you use the <strong class="command">ip addr</strong> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ip addr
<span class="go">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP qlen 1000</span>
<span class="go">link/ether xx:xx:xx:17:4b:c2 brd ff:ff:ff:ff:ff:ff</span>
<span class="go">inet 13.22.194.80/24 brd 13.22.194.255 scope global eth0</span>
<span class="go">inet 68.99.26.170/32 scope global eth0</span>
<span class="go">inet6 fe80::82b:2bf:fe1:4b2/64 scope link</span>
<span class="go">valid_lft forever preferred_lft forever</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You cannot use <code class="docutils literal"><span class="pre">SSH</span></code> to access an instance with a public IP from within
the same server because the routing configuration does not allow
it.</p>
</div>
</li>
<li><p class="first">Use <code class="docutils literal"><span class="pre">tcpdump</span></code> to identify if packets are being routed to the
inbound interface on the compute host. If the packets are reaching
the compute hosts but the connection is failing, the issue may be
that the packet is being dropped by reverse path filtering. Try
disabling reverse-path filtering on the inbound interface. For
example, if the inbound interface is <code class="docutils literal"><span class="pre">eth2</span></code>, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> sysctl -w net.ipv4.conf.ETH2.rp_filter<span class="o">=</span>0
</pre></div>
</div>
<p>If this solves the problem, add the following line to
<code class="docutils literal"><span class="pre">/etc/sysctl.conf</span></code> so that the reverse-path filter is persistent:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">net.ipv4.conf.rp_filter</span><span class="o">=</span><span class="s">0</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="temporarily-disable-firewall">
<h3>Temporarily disable firewall<a class="headerlink" href="#temporarily-disable-firewall" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id1">
<h3>Problem<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Networking issues prevent administrators accessing or reaching VM&#8217;s
through various pathways.</p>
</div>
<div class="section" id="id2">
<h3>Solution<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>You can disable the firewall by setting this option
in <code class="docutils literal"><span class="pre">/etc/nova/nova.conf</span></code>:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">firewall_driver</span><span class="o">=</span><span class="s">nova.virt.firewall.NoopFirewallDriver</span>
</pre></div>
</div>
</div>
<div class="section" id="packet-loss-from-instances-to-nova-network-server-vlanmanager-mode">
<h3>Packet loss from instances to nova-network server (VLANManager mode)<a class="headerlink" href="#packet-loss-from-instances-to-nova-network-server-vlanmanager-mode" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id3">
<h3>Problem<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>If you can access your instances with <code class="docutils literal"><span class="pre">SSH</span></code> but the network to your instance
is slow, or if you find that running certain operations are slower than
they should be (for example, <code class="docutils literal"><span class="pre">sudo</span></code>), packet loss could be occurring
on the connection to the instance.</p>
<p>Packet loss can be caused by Linux networking configuration settings
related to bridges. Certain settings can cause packets to be dropped
between the VLAN interface (for example, <code class="docutils literal"><span class="pre">vlan100</span></code>) and the associated
bridge interface (for example, <code class="docutils literal"><span class="pre">br100</span></code>) on the host running
<code class="docutils literal"><span class="pre">nova-network</span></code>.</p>
</div>
<div class="section" id="id4">
<h3>Solution<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>One way to check whether this is the problem is to open three terminals
and run the following commands:</p>
<ol class="arabic">
<li><p class="first">In the first terminal, on the host running <code class="docutils literal"><span class="pre">nova-network</span></code>, use
<code class="docutils literal"><span class="pre">tcpdump</span></code> on the VLAN interface to monitor DNS-related traffic
(UDP, port 53). As root, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> tcpdump -K -p -i vlan100 -v -vv udp port 53
</pre></div>
</div>
</li>
<li><p class="first">In the second terminal, also on the host running <code class="docutils literal"><span class="pre">nova-network</span></code>, use
<code class="docutils literal"><span class="pre">tcpdump</span></code> to monitor DNS-related traffic on the bridge interface.
As root, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> tcpdump -K -p -i br100 -v -vv udp port 53
</pre></div>
</div>
</li>
<li><p class="first">In the third terminal, use <code class="docutils literal"><span class="pre">SSH</span></code> to access the instance and generate DNS
requests by using the <strong class="command">nslookup</strong> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nslookup www.google.com
</pre></div>
</div>
<p>The symptoms may be intermittent, so try running <strong class="command">nslookup</strong>
multiple times. If the network configuration is correct, the command
should return immediately each time. If it is not correct, the
command hangs for several seconds before returning.</p>
</li>
<li><p class="first">If the <strong class="command">nslookup</strong> command sometimes hangs, and there are packets
that appear in the first terminal but not the second, then the
problem may be due to filtering done on the bridges. Try disabling
filtering, and running these commands as root:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> sysctl -w net.bridge.bridge-nf-call-arptables<span class="o">=</span>0
<span class="gp">#</span> sysctl -w net.bridge.bridge-nf-call-iptables<span class="o">=</span>0
<span class="gp">#</span> sysctl -w net.bridge.bridge-nf-call-ip6tables<span class="o">=</span>0
</pre></div>
</div>
<p>If this solves your issue, add the following line to
<code class="docutils literal"><span class="pre">/etc/sysctl.conf</span></code> so that the changes are persistent:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">net.bridge.bridge-nf-call-arptables</span><span class="o">=</span><span class="s">0</span>
<span class="na">net.bridge.bridge-nf-call-iptables</span><span class="o">=</span><span class="s">0</span>
<span class="na">net.bridge.bridge-nf-call-ip6tables</span><span class="o">=</span><span class="s">0</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="kvm-network-connectivity-works-initially-then-fails">
<h3>KVM: Network connectivity works initially, then fails<a class="headerlink" href="#kvm-network-connectivity-works-initially-then-fails" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id5">
<h3>Problem<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>With KVM hypervisors, instances running Ubuntu 12.04 sometimes lose
network connectivity after functioning properly for a period of time.</p>
</div>
<div class="section" id="id6">
<h3>Solution<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Try loading the <code class="docutils literal"><span class="pre">vhost_net</span></code> kernel module as a workaround for this
issue (see <a class="reference external" href="https://bugs.launchpad.net/ubuntu/+source/libvirt/+bug/997978/">bug
#997978</a>)
. This kernel module may also <a class="reference external" href="http://www.linux-kvm.org/page/VhostNet">improve network
performance</a> on KVM. To load
the kernel module:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> modprobe vhost_net
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Loading the module has no effect on running instances.</p>
</div>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="compute-images-instances.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Images and instances"></i></a>
          
          
            <a href="compute-system-admin.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: System administration"></i></a>
          
            <a id="logABugLink3" href="#" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2016-12-30 18:29</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org/" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='http://docs.openstack.org/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index-2.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/get-started-with-openstack.html">Get started with OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="identity-management.html">Identity management</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboard.html">Dashboard</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="compute.html">Compute</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="compute-arch.html">System architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute-images-instances.html">Images and instances</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Networking with nova-network</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute-system-admin.html">System administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="support-compute.html">Troubleshoot Compute</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="objectstorage.html">Object Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="blockstorage.html">Block Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="shared-file-systems.html">Shared File Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="networking.html">Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="telemetry.html">Telemetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="baremetal.html">Bare Metal</a></li>
<li class="toctree-l1"><a class="reference internal" href="orchestration.html">Orchestration</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">OpenStack command-line clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="cross-project.html">Cross-project features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org/">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org/">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org/">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com/" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.11.3.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "compute-networking-nova" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/admin-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 522e4919f8db2885f022e41fa599c8c3056b8485";
        var bugProject = "openstack-manuals";
        var bugTitle = "Networking with nova-network in Administrator Guide";
    var fieldTags = "admin-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2016-12-30 18:29";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>

<!-- Mirrored from docs.openstack.org/admin-guide/compute-networking-nova.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Jan 2017 09:06:28 GMT -->
</html>